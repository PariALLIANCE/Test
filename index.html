<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KING PRONOS</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">
    <link rel="manifest" href="manifest.json">
    <!-- Icône pour iOS -->
<link rel="apple-touch-icon" href="/iconios-192.png">

<!-- Web App installable (Standalone) -->
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="apple-mobile-web-app-title" content="King Pronos">
    <style>
        :root {
            /* Thème par défaut (bleu) */
            --primary-color: #5D5CDE;
            --text-color: #000000;
            --bg-color: #ffffff;
            --border-color: #dddfe2;
            --secondary-color: #f0f2f5;
            --card-bg: #ffffff;
            --card-border: #e0e0e0;
            --inactive-text: #8e8e93;
            --success-color: #4caf50;
            --danger-color: #ff4842;
            --warning-color: #ff9800;
            --shadow: rgba(0, 0, 0, 0.1);
            --chat-sent-bg: #5D5CDE;
            --chat-sent-text: #ffffff;
            --chat-received-bg: #f0f2f5;
            --selection-color: rgba(93, 92, 222, 0.3);
            --action-menu-bg: rgba(0, 0, 0, 0.9);
            --action-menu-text: #ffffff;
            --highlight-color: #FFEB3B;
            --blocked-color: #ff6b6b;
            --reaction-bg: rgba(255, 255, 255, 0.9);
            --reaction-shadow: rgba(0, 0, 0, 0.1);
            --group-icon-bg: #4CAF50;
            --input-bg: #f0f2f5;
            --input-placeholder: #8e8e93;
            --button-text: #000000;
            --link-color: #007aff;
            --admin-badge-bg: #5D5CDE;
            --admin-badge-text: white;
            --log-bg: rgba(0, 0, 0, 0.8);
            --log-text: #ffffff;
            --log-info: #2196F3;
            --log-warning: #FFC107;
            --log-error: #FF5252;
            --log-success: #4CAF50;
            --overlay-bg: rgba(0, 0, 0, 0.7);
            --event-bg: #f1f1f1;
            --event-border: #e0e0e0;
            --restricted-badge-bg: #FFC107;
            --restricted-badge-text: #000000;
            --side-menu-bg: #ffffff;
            --side-menu-active: #f0f2f5;
            --side-menu-hover: #f5f5f5;
            --log-panel-bg: #f8f9fa;
            --log-panel-border: #e0e0e0;
            --link-hover: #0056b3;
            --admin-notif-bg: #f8f9fa;
            --admin-notif-border: #e0e0e0;
            --forecast-win-bg: rgba(76, 175, 80, 0.2);
            --forecast-loss-bg: rgba(244, 67, 54, 0.2);
            --forecast-pending-bg: rgba(255, 193, 7, 0.2);
            --comment-bg: #f5f5f5;
            --comment-border: #ebebeb;
            --social-whatsapp: #25D366;
            --social-telegram: #0088cc;
            --social-youtube: #FF0000;
            --partner-google: #4285F4;
            --partner-firebase: #FFCA28;
            --partner-github: #333333;
            --partner-quora: #B92B27;
            --notification-dot: #FF4842;
            --warning-bg: rgba(255, 152, 0, 0.1);
            --warning-text: #FF9800;
            --image-message-bg: rgba(93, 92, 222, 0.1);
            --image-viewer-bg: rgba(0, 0, 0, 0.9);
            --selected-message-border: rgba(93, 92, 222, 0.7);
            --date-separator-bg: rgba(0, 0, 0, 0.05);
            --date-separator-text: var(--inactive-text);
            --reply-preview-bg: rgba(93, 92, 222, 0.1);
            --reply-preview-border: var(--primary-color);
            --reply-preview-text: var(--text-color);
            --deleted-message-bg: rgba(0, 0, 0, 0.05);
            --deleted-message-text: #888888;
            --action-bar-bg: var(--bg-color);
            --action-bar-text: var(--text-color);
            --action-bar-border: var(--border-color);
            --reply-quote-bg: rgba(93, 92, 222, 0.15);
            --reply-quote-border: var(--primary-color);
            --group-info-bg: var(--bg-color);
            --group-info-border: var(--border-color);
            --download-btn-bg: var(--primary-color);
            --download-btn-text: white;
            --new-badge-bg: var(--primary-color);
            --new-badge-text: white;
            --theme-selector-border: #ddd;
            --user-item-bg: var(--bg-color);
            --unread-badge-bg: #FF4842;
            --unread-badge-text: white;
            --sats-color: #F7931A;
            --plan-active-bg: rgba(93, 92, 222, 0.1);
            --plan-active-border: var(--primary-color);
            --premium-badge-bg: #FFD700;
            --premium-badge-text: #000000;
            --history-date-bg: rgba(93, 92, 222, 0.1);
            --history-date-text: var(--primary-color);
            --card-accent: var(--primary-color);
            --prediction-highlight-bg: rgba(93, 92, 222, 0.1);
            --prediction-highlight-text: var(--primary-color);
        }
        
        /* Thème vert */
        .theme-green {
            --primary-color: #4CAF50;
            --chat-sent-bg: #4CAF50;
            --selection-color: rgba(76, 175, 80, 0.3);
            --admin-badge-bg: #4CAF50;
            --reply-preview-bg: rgba(76, 175, 80, 0.1);
            --reply-preview-border: #4CAF50;
            --reply-quote-bg: rgba(76, 175, 80, 0.15);
            --reply-quote-border: #4CAF50;
            --download-btn-bg: #4CAF50;
            --new-badge-bg: #4CAF50;
            --image-message-bg: rgba(76, 175, 80, 0.1);
            --selected-message-border: rgba(76, 175, 80, 0.7);
            --history-date-bg: rgba(76, 175, 80, 0.1);
            --history-date-text: #4CAF50;
            --card-accent: #4CAF50;
            --prediction-highlight-bg: rgba(76, 175, 80, 0.1);
            --prediction-highlight-text: #4CAF50;
        }
        
        /* Thème rouge */
        .theme-red {
            --primary-color: #F44336;
            --chat-sent-bg: #F44336;
            --selection-color: rgba(244, 67, 54, 0.3);
            --admin-badge-bg: #F44336;
            --reply-preview-bg: rgba(244, 67, 54, 0.1);
            --reply-preview-border: #F44336;
            --reply-quote-bg: rgba(244, 67, 54, 0.15);
            --reply-quote-border: #F44336;
            --download-btn-bg: #F44336;
            --new-badge-bg: #F44336;
            --image-message-bg: rgba(244, 67, 54, 0.1);
            --selected-message-border: rgba(244, 67, 54, 0.7);
            --history-date-bg: rgba(244, 67, 54, 0.1);
            --history-date-text: #F44336;
            --card-accent: #F44336;
            --prediction-highlight-bg: rgba(244, 67, 54, 0.1);
            --prediction-highlight-text: #F44336;
        }
        
        /* Thème orange */
        .theme-orange {
            --primary-color: #FF9800;
            --chat-sent-bg: #FF9800;
            --selection-color: rgba(255, 152, 0, 0.3);
            --admin-badge-bg: #FF9800;
            --reply-preview-bg: rgba(255, 152, 0, 0.1);
            --reply-preview-border: #FF9800;
            --reply-quote-bg: rgba(255, 152, 0, 0.15);
            --reply-quote-border: #FF9800;
            --download-btn-bg: #FF9800;
            --new-badge-bg: #FF9800;
            --image-message-bg: rgba(255, 152, 0, 0.1);
            --selected-message-border: rgba(255, 152, 0, 0.7);
            --history-date-bg: rgba(255, 152, 0, 0.1);
            --history-date-text: #FF9800;
            --card-accent: #FF9800;
            --prediction-highlight-bg: rgba(255, 152, 0, 0.1);
            --prediction-highlight-text: #FF9800;
        }

        .theme-purple {
            --primary-color: #9C27B0;
            --card-accent: #9C27B0;
            --prediction-highlight-bg: rgba(156, 39, 176, 0.1);
            --prediction-highlight-text: #9C27B0;
        }

        .theme-teal {
            --primary-color: #009688;
            --card-accent: #009688;
            --prediction-highlight-bg: rgba(0, 150, 136, 0.1);
            --prediction-highlight-text: #009688;
        }

        .theme-indigo {
            --primary-color: #3F51B5;
            --card-accent: #3F51B5;
            --prediction-highlight-bg: rgba(63, 81, 181, 0.1);
            --prediction-highlight-text: #3F51B5;
        }

        .theme-pink {
            --primary-color: #E91E63;
            --card-accent: #E91E63;
            --prediction-highlight-bg: rgba(233, 30, 99, 0.1);
            --prediction-highlight-text: #E91E63;
        }

        .theme-cyan {
            --primary-color: #00BCD4;
            --card-accent: #00BCD4;
            --prediction-highlight-bg: rgba(0, 188, 212, 0.1);
            --prediction-highlight-text: #00BCD4;
        }

        .theme-lime {
            --primary-color: #CDDC39;
            --card-accent: #CDDC39;
            --prediction-highlight-bg: rgba(205, 220, 57, 0.1);
            --prediction-highlight-text: #CDDC39;
        }

        .theme-amber {
            --primary-color: #FFC107;
            --card-accent: #FFC107;
            --prediction-highlight-bg: rgba(255, 193, 7, 0.1);
            --prediction-highlight-text: #FFC107;
        }

        .theme-deep-orange {
            --primary-color: #FF5722;
            --card-accent: #FF5722;
            --prediction-highlight-bg: rgba(255, 87, 34, 0.1);
            --prediction-highlight-text: #FF5722;
        }
        
        .dark {
            --bg-color: #181818;
            --text-color: #ffffff;
            --border-color: #3e4042;
            --secondary-color: #2c2c2c;
            --card-bg: #2c2c2c;
            --card-border: #404040;
            --shadow: rgba(0, 0, 0, 0.3);
            --chat-received-bg: #2c2c2c;
            --chat-sent-text: #ffffff;
            --selection-color: rgba(93, 92, 222, 0.4);
            --action-menu-bg: rgba(60, 60, 60, 0.95);
            --highlight-color: #FFEB3B;
            --blocked-color: #ff6b6b;
            --reaction-bg: rgba(40, 40, 40, 0.9);
            --reaction-shadow: rgba(0, 0, 0, 0.3);
            --group-icon-bg: #388E3C;
            --danger-color: #ff6b6b;
            --success-color: #66bb6a;
            --input-bg: #2c2c2c;
            --input-placeholder: #6c6c6c;
            --link-color: #2196F3;
            --admin-badge-text: white;
            --log-bg: rgba(20, 20, 20, 0.9);
            --log-info: #64B5F6;
            --log-warning: #FFD54F;
            --log-error: #FF8A80;
            --log-success: #81C784;
            --overlay-bg: rgba(0, 0, 0, 0.8);
            --event-bg: #2a2a2a;
            --event-border: #3e3e3e;
            --restricted-badge-bg: #FFC107;
            --restricted-badge-text: #000000;
            --side-menu-bg: #222222;
            --side-menu-active: #333333;
            --side-menu-hover: #2a2a2a;
            --log-panel-bg: #222222;
            --log-panel-border: #3e3e3e;
            --link-hover: #64B5F6;
            --admin-notif-bg: #2a2a2a;
            --admin-notif-border: #333333;
            --forecast-win-bg: rgba(76, 175, 80, 0.15);
            --forecast-loss-bg: rgba(244, 67, 54, 0.15);
            --forecast-pending-bg: rgba(255, 193, 7, 0.15);
            --comment-bg: #2a2a2a;
            --comment-border: #333333;
            --notification-dot: #FF4842;
            --warning-bg: rgba(255, 152, 0, 0.15);
            --warning-text: #FFA726;
            --image-message-bg: rgba(93, 92, 222, 0.15);
            --image-viewer-bg: rgba(0, 0, 0, 0.95);
            --selected-message-border: rgba(93, 92, 222, 0.8);
            --date-separator-bg: rgba(255, 255, 255, 0.1);
            --date-separator-text: #aaaaaa;
            --reply-preview-bg: rgba(93, 92, 222, 0.15);
            --reply-preview-text: var(--text-color);
            --deleted-message-bg: rgba(255, 255, 255, 0.05);
            --deleted-message-text: #888888;
            --action-bar-bg: #222222;
            --action-bar-text: #ffffff;
            --action-bar-border: #3e3e3e;
            --reply-quote-bg: rgba(93, 92, 222, 0.2);
            --group-info-bg: #222222;
            --group-info-border: #3e3e3e;
            --download-btn-text: white;
            --theme-selector-border: #444;
            --user-item-bg: #222222;
            --plan-active-bg: rgba(93, 92, 222, 0.15);
            --history-date-bg: rgba(93, 92, 222, 0.15);
            --prediction-highlight-bg: rgba(93, 92, 222, 0.2);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            -webkit-tap-highlight-color: transparent;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            overflow-x: hidden;
            transition: all 0.3s ease;
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100vh;
            position: fixed;
            font-weight: 500;
            letter-spacing: -0.2px;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            -webkit-touch-callout: none;
            -webkit-user-drag: none;
            -khtml-user-drag: none;
            -moz-user-drag: none;
            -o-user-drag: none;
        }

        /* Header */
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60px;
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            z-index: 100;
            box-shadow: 0 2px 10px var(--shadow);
        }

        .header-left {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .back-btn, .menu-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            color: var(--text-color);
        }

        .back-btn:hover, .menu-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .header-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .header-actions {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .action-btn {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background-color: var(--secondary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
            color: var(--text-color);
            position: relative;
        }

        .action-btn:hover {
            background-color: var(--primary-color);
            color: white;
        }

        .notification-dot {
            position: absolute;
            top: 2px;
            right: 2px;
            width: 8px;
            height: 8px;
            background-color: var(--notification-dot);
            border-radius: 50%;
            display: none;
        }
        
        .notification-dot.active {
            display: block;
        }

        /* Main Content - Fixed for scrolling */
        .main-content {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            bottom: 60px;
            overflow: hidden;
            background-color: var(--bg-color);
        }

        /* Sections - Fixed for scrolling */
        .section {
            display: none;
            height: 100%;
            overflow: hidden;
        }
        
        .section.active {
            display: flex;
            flex-direction: column;
        }

        /* Forecast Cards Container - Fixed for scrolling */
        .forecasts-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            padding: 20px;
            overflow-y: auto;
            height: 100%;
            -webkit-overflow-scrolling: touch;
        }

        .forecast-card {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            border-radius: 15px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px var(--shadow);
            flex-shrink: 0;
        }

        .forecast-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px var(--shadow);
        }

        .forecast-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .league-info {
            font-size: 12px;
            color: var(--inactive-text);
            background-color: var(--secondary-color);
            padding: 4px 8px;
            border-radius: 10px;
        }

        .forecast-status {
            font-size: 12px;
            font-weight: bold;
            padding: 4px 10px;
            border-radius: 15px;
        }

        .status-pending {
            background-color: rgba(255, 152, 0, 0.2);
            color: var(--warning-color);
        }

        .status-win {
            background-color: rgba(76, 175, 80, 0.2);
            color: var(--success-color);
        }

        .status-loss {
            background-color: rgba(244, 67, 54, 0.2);
            color: var(--danger-color);
        }

        .teams-container {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin-bottom: 15px;
            gap: 10px;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 0;
        }

        .team-logo {
            width: 60px;
            height: 60px;
            background: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            border: 3px solid var(--border-color);
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .team-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .team-logo i {
            font-size: 28px;
            color: var(--primary-color);
            z-index: 1;
        }

        .team-name {
            font-weight: bold;
            text-align: center;
            font-size: 13px;
            line-height: 1.3;
            max-width: 80px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .forecast-vs {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 15px;
            flex-shrink: 0;
            min-width: 80px;
        }

        .vs-text {
            font-size: 32px;
            color: var(--text-color);
            font-weight: bold;
        }

        .forecast-time {
            font-size: 12px;
            color: var(--inactive-text);
            text-align: center;
        }

        .confidence-bar-container {
            width: 100%;
            height: 6px;
            background-color: var(--border-color);
            border-radius: 3px;
            margin: 10px 0;
            overflow: hidden;
        }

        .confidence-bar {
            height: 100%;
            background-color: var(--primary-color);
            border-radius: 3px;
            transition: width 0.3s ease;
        }

        /* Forecast Detail Page - Restructured */
        .forecast-detail {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-color);
            z-index: 200;
            display: none;
            flex-direction: column;
        }

        .forecast-detail.active {
            display: flex;
        }

        /* Fixed header section with teams */
        .forecast-info-section {
            position: fixed;
            top: 60px;
            left: 0;
            right: 0;
            background-color: var(--bg-color);
            border-bottom: 1px solid var(--border-color);
            padding: 20px;
            z-index: 10;
            height: 200px;
        }

        .detail-teams {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            margin: 20px 0;
            gap: 15px;
        }

        .detail-team {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 0;
        }

        .detail-team-logo {
            width: 80px;
            height: 80px;
            background: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 10px;
            border: 3px solid var(--border-color);
            flex-shrink: 0;
            position: relative;
            overflow: hidden;
        }

        .detail-team-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .detail-team-logo i {
            font-size: 40px;
            color: var(--primary-color);
            z-index: 1;
        }

        .detail-team-name {
            font-weight: bold;
            font-size: 16px;
            text-align: center;
            max-width: 100px;
            word-wrap: break-word;
            overflow-wrap: break-word;
            hyphens: auto;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .detail-prediction {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 20px;
            flex-shrink: 0;
            min-width: 100px;
        }

        .detail-prediction-value {
            font-size: 24px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
            text-align: center;
            display: none;
        }

        .detail-forecast-status {
            font-size: 14px;
            font-weight: bold;
            padding: 6px 12px;
            border-radius: 20px;
            margin-bottom: 5px;
        }

        .detail-forecast-time {
            font-size: 12px;
            color: var(--inactive-text);
        }

        /* Scrollable content area */
        .detail-scrollable-content {
            margin-top: 260px;
            flex: 1;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            -webkit-overflow-scrolling: touch;
        }

        /* Tabs */
        .detail-tabs {
            display: flex;
            background-color: var(--secondary-color);
            margin: 0 20px;
            border-radius: 10px;
            padding: 4px;
            position: sticky;
            top: 0;
            z-index: 5;
            flex-shrink: 0;
        }

        .detail-tab {
            flex: 1;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            font-size: 12px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            color: var(--inactive-text);
        }

        .detail-tab.active {
            background-color: var(--primary-color);
            color: white;
        }

        /* Tab Content */
        .tab-content {
            padding: 20px;
            display: none;
            flex: 1;
        }

        .tab-content.active {
            display: block;
        }

        .analysis-section {
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .analysis-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }

        .analysis-content {
            font-size: 14px;
            line-height: 1.5;
            white-space: pre-line;
        }

        .prediction-highlight {
            background-color: var(--prediction-highlight-bg);
            color: var(--prediction-highlight-text);
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
        }

        .confidence-info {
            background-color: var(--primary-color);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
        }

        .probability-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .probability-item:last-child {
            border-bottom: none;
        }

        .probability-label {
            font-weight: 500;
        }

        .probability-value {
            font-weight: bold;
            color: var(--primary-color);
        }

        /* Score Prediction - Reduced size */
        .score-prediction {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }

        .score-item {
            background-color: var(--secondary-color);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
            min-width: 0;
        }

        .score-value {
            font-size: 14px;
            font-weight: bold;
            margin-bottom: 3px;
            word-break: keep-all;
        }

        .score-probability {
            font-size: 10px;
            color: var(--inactive-text);
        }

        /* AI Forecasts Tabs */
        .ai-forecasts-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            margin: 0;
            background-color: var(--bg-color);
            position: sticky;
            top: 0;
            z-index: 5;
            flex-shrink: 0;
        }
        
        .ai-forecast-tab {
            flex: 1;
            text-align: center;
            padding: 12px 0;
            font-weight: bold;
            font-size: 14px;
            cursor: pointer;
            position: relative;
            color: var(--inactive-text);
            transition: color 0.3s, background-color 0.2s ease;
        }
        
        .ai-forecast-tab.active {
            color: var(--primary-color);
        }
        
        .ai-forecast-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 20%;
            width: 60%;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px 3px 0 0;
            animation: slideIn 0.3s ease;
        }

        .ai-forecasts-content {
            display: none;
            flex: 1;
            overflow: hidden;
        }
        
        .ai-forecasts-content.active {
            display: flex;
            flex-direction: column;
        }

        /* Loading and Empty States */
        .loading-state {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 60px 20px;
            height: 100%;
        }

        .loading-spinner {
            font-size: 40px;
            color: var(--primary-color);
            animation: spin 1s linear infinite;
            margin-bottom: 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--inactive-text);
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .empty-state i {
            font-size: 60px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .empty-state p {
            font-size: 14px;
            line-height: 1.5;
        }

        /* Side menu */
        .side-menu {
            position: fixed;
            top: 0;
            left: -250px;
            height: 100%;
            width: 250px;
            background-color: var(--side-menu-bg);
            z-index: 1000;
            transition: left 0.3s ease;
            box-shadow: 2px 0 10px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
        }
        
        .side-menu.active {
            left: 0;
        }
        
        .side-menu-header {
            display: flex;
            align-items: center;
            padding: 20px 15px;
            border-bottom: none;
        }
        
        .side-menu-title {
            font-size: 20px;
            font-weight: bold;
            color: var(--primary-color);
            margin-left: 15px;
        }
        
        .side-menu-close {
            font-size: 20px;
            color: var(--text-color);
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
        }
        
        .side-menu-content {
            flex: 1;
            overflow-y: auto;
        }
        
        .side-menu-item {
            padding: 15px 20px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .side-menu-item.active {
            background-color: var(--side-menu-active);
        }
        
        .side-menu-item i {
            font-size: 20px;
            width: 30px;
            color: var(--primary-color);
        }
        
        .side-menu-text {
            margin-left: 15px;
            font-weight: 500;
        }
        
        .side-menu-footer {
            margin-top: auto;
        }
        
        .side-menu-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }
        
        .side-menu-overlay.active {
            display: block;
        }

        /* Bottom Navigation */
        .bottom-nav {
            background-color: var(--bg-color);
            border-top: 1px solid var(--border-color);
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            height: 60px;
            display: flex;
            z-index: 100;
            box-shadow: 0 -2px 10px var(--shadow);
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            flex: 1;
            color: var(--inactive-text);
            font-size: 10px;
            cursor: pointer;
            height: 100%;
            padding: 8px 0;
            position: relative;
            transition: all 0.3s ease;
        }

        .nav-item.active {
            color: var(--primary-color);
        }

        .nav-icon {
            font-size: 20px;
            margin-bottom: 4px;
        }

        /* Auth screen styles */
        .auth-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-color);
            z-index: 1000;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
        }
        
        .auth-header {
            padding: 40px 0 20px;
            text-align: center;
        }
        
        .auth-logo {
            font-size: 50px;
            color: var(--primary-color);
            margin-bottom: 15px;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }
        
        .auth-title {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .auth-subtitle {
            font-size: 16px;
            color: var(--text-color);
            opacity: 0.8;
            margin-bottom: 20px;
            padding: 0 20px;
            text-align: center;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: none;
        }
        
        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 15px 0;
            font-weight: bold;
            cursor: pointer;
            position: relative;
            color: var(--inactive-text);
            transition: color 0.3s, background-color 0.2s ease;
            text-decoration: none;
            border-bottom: none;
        }
        
        .auth-tab.active {
            color: var(--primary-color);
        }
        
        .auth-tab.active::after {
            content: '';
            position: absolute;
            bottom: -1px;
            left: 25%;
            width: 50%;
            height: 3px;
            background-color: var(--primary-color);
            border-radius: 3px 3px 0 0;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: scaleX(0); }
            to { transform: scaleX(1); }
        }
        
        .auth-form {
            padding: 20px;
            display: none;
            animation: fadeUp 0.5s ease;
        }
        
        @keyframes fadeUp {
            from { 
                opacity: 0;
                transform: translateY(20px);
            }
            to { 
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .auth-form.active {
            display: block;
        }
        
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            font-size: 14px;
        }
        
        .form-input {
            width: 100%;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid var(--border-color);
            background-color: var(--input-bg);
            font-size: 16px;
            color: var(--text-color);
            transition: border-color 0.3s ease, box-shadow 0.3s ease;
            outline: none;
        }
        
        .form-input:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(93, 92, 222, 0.25);
        }
        
        .form-input::placeholder {
            color: var(--input-placeholder);
        }
        
        .form-error {
            color: var(--danger-color);
            font-size: 13px;
            margin-top: 6px;
            display: none;
            animation: shakeX 0.75s ease;
        }
        
        @keyframes shakeX {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-4px); }
            20%, 40%, 60%, 80% { transform: translateX(4px); }
        }
        
        .form-footer {
            margin-top: 30px;
            text-align: center;
        }
        
        .form-footer-text {
            margin-top: 15px;
            font-size: 14px;
            color: var(--text-color);
            opacity: 0.8;
        }
        
        .form-link {
            color: var(--link-color);
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s;
        }
        
        .form-link:hover {
            text-decoration: underline;
        }

        .button {
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 10px;
            padding: 12px;
            font-size: 16px;
            font-weight: bold;
            width: 100%;
            margin-top: 20px;
            cursor: pointer;
            transition: transform 0.15s ease, opacity 0.2s ease, background-color 0.2s ease;
            position: relative;
            overflow: hidden;
        }
        
        .button:active {
            transform: scale(0.98);
            opacity: 0.9;
        }
        
        .button:hover {
            background-color: #4a49c0;
        }

        .button:disabled {
            background-color: var(--border-color);
            color: var(--inactive-text);
            cursor: not-allowed;
        }
        
        .button.danger {
            background-color: var(--danger-color);
            color: white;
        }
        
        .button.danger:hover {
            background-color: #e53935;
        }

        .log-message {
            margin-top: 15px;
            padding: 12px;
            font-weight: bold;
            border-radius: 6px;
            white-space: pre-line;
            text-align: center;
            animation: fadeIn 0.5s ease;
        }
          
        .log-message.info {
            background: #d1ecf1;
            color: #0c5460;
        }
          
        .log-message.success {
            background: #d4edda;
            color: #155724;
        }
          
        .log-message.error {
            background: #f8d7da;
            color: #721c24;
        }

        .btn-loader {
            display: inline-block;
            width: 20px;
            height: 20px;
            margin-right: 8px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 0.8s linear infinite;
            vertical-align: middle;
        }
        
        .button.loading {
            pointer-events: none;
            opacity: 0.8;
        }
        
        .button.loading .btn-text {
            visibility: hidden;
        }
        
        .button.loading .btn-loader {
            position: absolute;
            top: 50%;
            left: 50%;
            margin-top: -10px;
            margin-left: -10px;
            visibility: visible;
        }

        .loading {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--bg-color);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 999;
        }
        
        .loading-spinner-main {
            font-size: 60px;
            color: var(--primary-color);
            animation: pulse 2s infinite, bounce 1.5s infinite;
            margin-bottom: 20px;
            text-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-20px); }
            60% { transform: translateY(-10px); }
        }

        .notification {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            opacity: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            padding: 12px 20px;
            border-radius: 15px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
            font-weight: 500;
            z-index: 1000;
            max-width: 90%;
            text-align: center;
            line-height: 1.4;
            transition: opacity 0.3s ease, transform 0.3s ease;
            pointer-events: none;
        }

        .notification.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
            pointer-events: auto;
        }

        .notification.success {
            background-color: var(--bg-color);
            color: var(--success-color);
        }

        .notification.error {
            background-color: var(--bg-color);
            color: var(--danger-color);
        }

        .notification.info {
            background-color: var(--bg-color);
            color: var(--primary-color);
        }

        /* Admin styles needed */
        .admin-badge {
            display: inline-block;
            background-color: var(--admin-badge-bg);
            color: var(--admin-badge-text);
            font-size: 10px;
            padding: 2px 6px;
            border-radius: 10px;
            margin-left: 6px;
            font-weight: bold;
            text-transform: uppercase;
        }

        .profile-header {
            display: flex;
            align-items: flex-start;
            padding: 20px;
            border-bottom: none;
        }
        
        .profile-pic {
            width: 80px;
            height: 80px;
            background-color: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 20px;
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
            cursor: pointer;
            border: 3px solid var(--primary-color);
            transition: all 0.3s ease;
        }

        .profile-pic:hover {
            transform: scale(1.05);
        }
        
        .profile-pic img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            pointer-events: none;
        }
        
        .profile-pic i {
            font-size: 32px;
            color: var(--primary-color);
        }
        
        .profile-info {
            display: flex;
            flex-direction: column;
            flex: 1;
        }
        
        .profile-name {
            font-weight: bold;
            font-size: 20px;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
        }
        
        .profile-email {
            color: #6b7280;
            font-size: 16px;
            margin-bottom: 5px;
        }
        
        .profile-status {
            color: #6b7280;
        }

        .settings-container {
            padding: 15px;
            overflow-y: auto;
            height: calc(100% - 140px);
        }

        .social-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 0 15px;
            gap: 15px;
        }
        
        .social-button {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px 10px;
            border-radius: 15px;
            text-align: center;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            color: white;
            font-weight: bold;
            font-size: 16px;
            text-decoration: none;
        }
        
        .social-button:active {
            transform: scale(0.98);
        }
        
        .social-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        
        .social-button.whatsapp {
            background-color: var(--social-whatsapp);
        }
        
        .social-button.telegram {
            background-color: var(--social-telegram);
        }
        
        .social-button.youtube {
            background-color: var(--social-youtube);
        }

        .social-button .social-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .section-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 10px;
            text-decoration: none;
            border-bottom: none;
            padding: 0 16px; 
            margin: 15px 0;
        }

        /* Avatar Viewer Modal */
        .avatar-viewer-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--image-viewer-bg);
            z-index: 300;
            display: none;
            align-items: center;
            justify-content: center;
            flex-direction: column;
        }

        .avatar-viewer-modal.active {
            display: flex;
        }

        .avatar-viewer-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            max-width: 90%;
            max-height: 90%;
        }

        .avatar-viewer-image {
            width: 250px;
            height: 250px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary-color);
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .avatar-viewer-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
        }

        .avatar-viewer-btn {
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 16px;
            transition: all 0.3s ease;
            min-width: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .avatar-viewer-btn:hover {
            transform: translateY(-2px);
        }

        .avatar-viewer-btn.edit {
            background-color: var(--primary-color);
            color: white;
        }

        .avatar-viewer-btn.edit:hover {
            background-color: #4a49c0;
        }

        .avatar-viewer-btn.close {
            background-color: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .avatar-viewer-btn.close:hover {
            background-color: rgba(255, 255, 255, 0.3);
        }

        /* Avatar Selector Modal */
        .avatar-selector-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 350;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .avatar-selector-modal.active {
            display: flex;
        }

        .avatar-modal-content {
            background-color: var(--bg-color);
            border-radius: 20px;
            padding: 30px;
            max-width: 400px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .avatar-modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .avatar-modal-title {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .avatar-modal-subtitle {
            font-size: 14px;
            color: var(--inactive-text);
            line-height: 1.4;
        }

        .avatar-modal-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .avatar-modal-option {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            border: 3px solid var(--border-color);
            overflow: hidden;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            background-color: var(--secondary-color);
            justify-self: center;
        }

        .avatar-modal-option img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .avatar-modal-option:hover {
            transform: scale(1.1);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .avatar-modal-option.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color), 0.3);
            transform: scale(1.15);
        }

        .avatar-modal-option.active:after {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            bottom: -5px;
            right: -5px;
            background-color: var(--primary-color);
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            z-index: 3;
            border: 2px solid var(--bg-color);
        }

        .avatar-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .avatar-modal-button {
            padding: 12px 25px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 14px;
            transition: all 0.3s ease;
            min-width: 100px;
        }

        .avatar-modal-cancel {
            background-color: var(--secondary-color);
            color: var(--text-color);
        }

        .avatar-modal-cancel:hover {
            background-color: var(--border-color);
        }

        .avatar-modal-save {
            background-color: var(--primary-color);
            color: white;
        }

        .avatar-modal-save:hover {
            background-color: #4a49c0;
        }

        .avatar-modal-save:disabled {
            background-color: var(--border-color);
            color: var(--inactive-text);
            cursor: not-allowed;
        }

        .avatar-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--inactive-text);
        }

        .avatar-loading i {
            font-size: 24px;
            animation: spin 1s linear infinite;
        }

        /* Other required styles but adapt to new layout */
        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 90;
            display: none;
        }
        
        .overlay.active {
            display: block;
        }

        .confirmation-dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--bg-color);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            width: 85%;
            max-width: 300px;
            padding: 20px;
            z-index: 150;
            display: none;
        }
        
        .confirmation-dialog.active {
            display: block;
        }
        
        .confirmation-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .confirmation-text {
            margin-bottom: 20px;
            text-align: center;
            line-height: 1.4;
        }
        
        .confirmation-buttons {
            display: flex;
            justify-content: space-between;
            gap: 10px;
        }
        
        .confirmation-button {
            padding: 10px 15px;
            border-radius: 6px;
            font-weight: bold;
            cursor: pointer;
            flex: 1;
            text-align: center;
        }
        
        .confirmation-cancel {
            background-color: var(--secondary-color);
            color: var(--text-color);
        }
        
        .confirmation-confirm {
            background-color: var(--primary-color);
            color: white;
        }
        
        .confirmation-delete {
            background-color: var(--danger-color);
            color: white;
        }

        /* Admin notification styles */
        .admin-notification {
            background-color: var(--bg-color);
            border-radius: 15px;
            margin: 10px 15px 20px;
            padding: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            position: relative;
        }
        
        .admin-notification-header {
            color: var(--text-color);
            padding: 0 0 10px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: none;
            margin-bottom: 10px;
        }
        
        .admin-notification-title {
            display: flex;
            align-items: center;
        }
        
        .admin-notification-title i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .admin-notification-content {
            padding: 5px 0;
            line-height: 1.4;
        }
        
        .admin-notification-footer {
            padding: 5px 0 0;
            font-size: 12px;
            color: var(--inactive-text);
            text-align: right;
            border-top: none;
            margin-top: 10px;
            padding-top: 8px;
        }

        .interface-sections {
            display: flex;
            flex-direction: column;
            gap: 20px;
            padding: 20px;
            overflow-y: auto;
            height: 100%;
        }

        .interface-section {
            background: linear-gradient(135deg, var(--secondary-color), rgba(var(--primary-color), 0.05));
            border-radius: 15px;
            padding: 20px;
            border: 1px solid rgba(var(--primary-color), 0.1);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .interface-section:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.12);
        }
        
        .interface-title {
            font-weight: bold;
            margin-bottom: 15px;
            font-size: 18px;
            color: var(--primary-color);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .interface-title i {
            font-size: 20px;
        }

        .interface-subtitle {
            font-size: 13px;
            color: var(--inactive-text);
            margin-bottom: 15px;
            line-height: 1.4;
        }
        
        .theme-selector {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            margin: 15px 0;
        }
        
        .theme-option {
            width: 100%;
            height: 70px;
            border-radius: 12px;
            cursor: pointer;
            position: relative;
            border: 2px solid var(--theme-selector-border);
            overflow: hidden;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .theme-option:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }
        
        .theme-option.active {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 3px rgba(var(--primary-color), 0.3);
            transform: scale(1.1);
        }
        
        .theme-option.active:before {
            content: '\f00c';
            font-family: 'Font Awesome 5 Free';
            font-weight: 900;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            text-shadow: 0 0 5px rgba(0,0,0,0.7);
            z-index: 3;
        }
        
        .theme-option.theme-blue {
            background: linear-gradient(135deg, #5D5CDE, #4a49c0);
        }
        
        .theme-option.theme-green {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
        }
        
        .theme-option.theme-red {
            background: linear-gradient(135deg, #F44336, #d32f2f);
        }
        
        .theme-option.theme-orange {
            background: linear-gradient(135deg, #FF9800, #f57c00);
        }

        .theme-option.theme-purple {
            background: linear-gradient(135deg, #9C27B0, #7B1FA2);
        }

        .theme-option.theme-teal {
            background: linear-gradient(135deg, #009688, #00695C);
        }

        .theme-option.theme-indigo {
            background: linear-gradient(135deg, #3F51B5, #303F9F);
        }

        .theme-option.theme-pink {
            background: linear-gradient(135deg, #E91E63, #C2185B);
        }

        .theme-option.theme-cyan {
            background: linear-gradient(135deg, #00BCD4, #0097A7);
        }

        .theme-option.theme-lime {
            background: linear-gradient(135deg, #CDDC39, #AFB42B);
        }

        .theme-option.theme-amber {
            background: linear-gradient(135deg, #FFC107, #FF8F00);
        }

        .theme-option.theme-deep-orange {
            background: linear-gradient(135deg, #FF5722, #D84315);
        }
        
        .theme-label {
            margin-top: 8px;
            font-size: 10px;
            text-align: center;
            font-weight: 600;
            line-height: 1.2;
            color: var(--text-color);
            opacity: 0.8;
        }

        .setting-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: none;
            cursor: pointer;
        }
        
        .setting-icon {
            width: 36px;
            height: 36px;
            background-color: var(--secondary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 15px;
        }
        
        .setting-row {
            display: flex;
            align-items: center;
            flex: 1;
        }
        
        .setting-label {
            font-weight: 500;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 26px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 18px;
            width: 18px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary-color);
        }
        
        input:checked + .slider:before {
            transform: translateX(24px);
        }

        /* History styles */
        .history-date-header {
            background-color: var(--history-date-bg);
            color: var(--history-date-text);
            padding: 12px 20px;
            margin: 0 15px 15px;
            border-radius: 10px;
            font-weight: bold;
            text-align: center;
            font-size: 16px;
        }

        .history-category-section {
            margin-bottom: 25px;
        }

        .history-category-title {
            background-color: var(--secondary-color);
            padding: 10px 20px;
            margin: 0 15px 10px;
            border-radius: 8px;
            font-weight: bold;
            color: var(--primary-color);
            font-size: 14px;
            text-transform: uppercase;
        }

        .history-forecasts-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
            padding: 0 15px;
        }

        .history-forecast-item {
            background-color: var(--secondary-color);
            border-radius: 10px;
            padding: 15px;
            border-left: 4px solid var(--primary-color);
            opacity: 0.9;
            transform: scale(0.98);
        }

        .history-forecast-item .forecast-status.win {
            background-color: var(--forecast-win-bg);
            color: var(--success-color);
        }

        .history-forecast-item .forecast-status.loss {
            background-color: var(--forecast-loss-bg);
            color: var(--danger-color);
        }

        .history-forecast-item .forecast-status.pending {
            background-color: var(--forecast-pending-bg);
            color: var(--text-color);
        }

        /* Info Modal */
        .info-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 300;
            display: none;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .info-modal.active {
            display: flex;
        }

        .info-modal-content {
            background-color: var(--bg-color);
            border-radius: 20px;
            padding: 30px;
            max-width: 500px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .info-modal-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .info-modal-title {
            font-size: 22px;
            font-weight: bold;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .info-modal-text {
            font-size: 14px;
            line-height: 1.6;
            color: var(--text-color);
            margin-bottom: 20px;
        }

        .info-modal-text h3 {
            color: var(--primary-color);
            margin-top: 20px;
            margin-bottom: 10px;
        }

        .info-modal-text h3:first-child {
            margin-top: 0;
        }

        .info-modal-buttons {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .info-modal-button {
            padding: 12px 30px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            border: none;
            font-size: 16px;
            transition: all 0.3s ease;
            background-color: var(--primary-color);
            color: white;
        }

        .info-modal-button:hover {
            background-color: #4a49c0;
        }

        /* Responsive */
        @media (max-width: 480px) {
            .header {
                padding: 0 15px;
            }

            .teams-container {
                margin-bottom: 10px;
                gap: 8px;
            }

            .team-name, .detail-team-name {
                font-size: 12px;
            }

            .score-prediction {
                grid-template-columns: repeat(2, 1fr);
            }

            .score-item {
                padding: 6px;
            }

            .score-value {
                font-size: 12px;
            }

            .score-probability {
                font-size: 9px;
            }

            .detail-scrollable-content {
                margin-top: 240px;
            }

            .forecast-info-section {
                height: 180px;
            }

            .detail-team-logo {
                width: 70px;
                height: 70px;
            }

            .team-logo {
                width: 50px;
                height: 50px;
            }

            .nav-icon {
                font-size: 18px;
            }

            .avatar-modal-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .avatar-viewer-image {
                width: 200px;
                height: 200px;
            }

            .avatar-viewer-buttons {
                flex-direction: column;
                width: 100%;
                max-width: 200px;
            }

            .info-modal-content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <!-- Loading Screen -->
    <div id="loading" class="loading" style="display: none;">
        <i class="fas fa-futbol loading-spinner-main"></i>
        <div style="font-weight: bold; font-size: 24px; color: var(--primary-color);">KING PRONOS</div>
        <div style="margin-top: 10px; color: #6b7280;">Chargement...</div>
    </div>

    <!-- Auth Screen -->
    <div id="auth-screen" class="auth-screen" style="display: none;">
        <div class="auth-header">
            <div class="auth-logo">
                <i class="fas fa-futbol"></i>
            </div>
            <h1 class="auth-title">KING PRONOS</h1>
            <p class="auth-subtitle">Pronostics sportifs avancés</p>
        </div>
        
        <div class="auth-tabs">
            <div class="auth-tab active" id="login-tab">Connexion</div>
            <div class="auth-tab" id="register-tab">Inscription</div>
        </div>
        
        <div id="login-form" class="auth-form active">
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="login-email" placeholder="Votre email">
                <div id="login-email-error" class="form-error">Veuillez entrer un email valide</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Mot de passe</label>
                <input type="password" class="form-input" id="login-password" placeholder="Votre mot de passe">
                <div id="login-password-error" class="form-error">Le mot de passe est obligatoire</div>
            </div>
            
            <div id="login-log" class="log-message" style="display:none;"></div>

            <div class="form-footer">
                <button class="button" id="loginBtn">
                    <span class="btn-loader" style="display:none;"></span>
                    <span class="btn-text">Se connecter</span>
                </button>
                <p class="form-footer-text">
                    Vous n'avez pas de compte ? <a href="#" class="form-link" id="goto-register">S'inscrire</a>
                </p>
            </div>
        </div>
        
        <div id="register-form" class="auth-form">
            <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-input" id="register-email" placeholder="Votre adresse email">
                <div id="register-email-error" class="form-error">Veuillez entrer un email valide</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Mot de passe</label>
                <input type="password" class="form-input" id="register-password" placeholder="Créez un mot de passe sécurisé">
                <div id="register-password-error" class="form-error">Le mot de passe doit contenir au moins 6 caractères</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Confirmer le mot de passe</label>
                <input type="password" class="form-input" id="register-confirm-password" placeholder="Confirmez votre mot de passe">
                <div id="register-confirm-password-error" class="form-error">Les mots de passe ne correspondent pas</div>
            </div>
            
            <div id="register-log" class="log-message" style="display:none;"></div>

            <div class="form-footer">
                <button class="button" id="registerBtn">
                    <span class="btn-loader" style="display:none;"></span>
                    <span class="btn-text">S'inscrire</span>
                </button>
                <p class="form-footer-text">
                    Vous avez déjà un compte ? <a href="#" class="form-link" id="goto-login">Se connecter</a>
                </p>
            </div>
        </div>
    </div>

    <!-- Side Menu -->
    <div class="side-menu" id="side-menu">
        <div class="side-menu-header">
            <div class="side-menu-close" id="side-menu-close">
                <i class="fas fa-times"></i>
            </div>
            <div class="side-menu-title">KING PRONOS</div>
        </div>
        <div class="side-menu-content">
            <div class="side-menu-item" id="menu-history">
                <i class="fas fa-history"></i>
                <div class="side-menu-text">Historique</div>
            </div>
            <div class="side-menu-item" id="menu-interface">
                <i class="fas fa-palette"></i>
                <div class="side-menu-text">Interface</div>
            </div>
        </div>
        <div class="side-menu-footer">
            <div class="side-menu-item" id="menu-terms">
                <i class="fas fa-file-alt"></i>
                <div class="side-menu-text">Conditions d'utilisation</div>
            </div>
            <div class="side-menu-item" id="menu-about">
                <i class="fas fa-info-circle"></i>
                <div class="side-menu-text">À propos</div>
            </div>
        </div>
    </div>
    
    <div class="side-menu-overlay" id="side-menu-overlay"></div>

    <!-- Avatar Viewer Modal -->
    <div class="avatar-viewer-modal" id="avatar-viewer-modal">
        <div class="avatar-viewer-content">
            <img class="avatar-viewer-image" id="avatar-viewer-image" src="" alt="Avatar">
            <div class="avatar-viewer-buttons">
                <button class="avatar-viewer-btn edit" id="avatar-edit-btn">
                    <i class="fas fa-edit"></i>
                    Modifier
                </button>
                <button class="avatar-viewer-btn close" id="avatar-viewer-close">
                    <i class="fas fa-times"></i>
                    Fermer
                </button>
            </div>
        </div>
    </div>

    <!-- Avatar Selector Modal -->
    <div class="avatar-selector-modal" id="avatar-selector-modal">
        <div class="avatar-modal-content">
            <div class="avatar-modal-header">
                <div class="avatar-modal-title">Choisissez votre avatar</div>
                <div class="avatar-modal-subtitle">Sélectionnez l'avatar qui vous représente le mieux</div>
            </div>
            <div class="avatar-modal-grid" id="avatar-modal-grid">
                <!-- Avatar options will be loaded here -->
            </div>
            <div class="avatar-modal-buttons">
                <button class="avatar-modal-button avatar-modal-cancel" id="avatar-modal-cancel">Annuler</button>
                <button class="avatar-modal-button avatar-modal-save" id="avatar-modal-save" disabled>Sauvegarder</button>
            </div>
        </div>
    </div>

    <!-- Info Modal -->
    <div class="info-modal" id="info-modal">
        <div class="info-modal-content">
            <div class="info-modal-header">
                <div class="info-modal-title" id="info-modal-title">Conditions d'utilisation</div>
            </div>
            <div class="info-modal-text" id="info-modal-text">
                <!-- Content will be filled dynamically -->
            </div>
            <div class="info-modal-buttons">
                <button class="info-modal-button" id="info-modal-close">Fermer</button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <button class="back-btn" id="back-btn" style="display: none;">
                <i class="fas fa-arrow-left"></i>
            </button>
            <button class="menu-btn" id="menu-btn">
                <i class="fas fa-bars"></i>
            </button>
            <div class="header-title" id="header-title">Simples</div>
        </div>
        <div class="header-actions">
            <button class="action-btn" id="search-btn">
                <i class="fas fa-search"></i>
            </button>
            <button class="action-btn" id="events-btn">
                <i class="fas fa-bell"></i>
                <div class="notification-dot" id="events-notification-dot"></div>
            </button>
        </div>
    </div>

    <!-- Main Content -->
    <div class="main-content" id="main-content">
        <!-- Simple Forecasts Section -->
        <div id="forecasts-section" class="section active">
            <div class="forecasts-container" id="forecasts-container">
                <!-- Loading state -->
                <div class="loading-state" id="loading-state">
                    <i class="fas fa-futbol loading-spinner"></i>
                    <h3>Chargement...</h3>
                    <p>Veuillez patienter</p>
                </div>
            </div>
        </div>

        <!-- AI Forecasts Section -->
        <div id="ai-forecasts-section" class="section">
            <div class="ai-forecasts-tabs">
                <div class="ai-forecast-tab active" data-tab="ia-singles">Singles Premium</div>
                <div class="ai-forecast-tab" data-tab="safes">Safes</div>
            </div>
            
            <div class="ai-forecasts-content active" id="ia-singles-content">
                <div class="forecasts-container" id="ia-singles-list">
                </div>
            </div>

            <div class="ai-forecasts-content" id="safes-content">
                <div class="forecasts-container" id="safes-list">
                </div>
            </div>
        </div>

        <!-- Profile Section -->
        <div id="profile-section" class="section">
            <div style="height: 100%; overflow-y: auto;">
                <div class="profile-header">
                    <div class="profile-pic" id="profile-pic">
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="profile-info">
                        <div class="profile-name" id="profile-name">
                            <span id="profile-name-text">Utilisateur</span>
                            <span class="admin-badge" id="admin-badge" style="display: none;">Admin</span>
                        </div>
                        <div class="profile-email" id="profile-email">user@example.com</div>
                        <div class="profile-status">En ligne</div>
                    </div>
                </div>
                
                <div class="section-title">Paramètres</div>
                
                <div class="settings-container">
                    <div class="section-title">Nous rejoindre</div>
                    
                    <div class="social-buttons">
                        <a href="https://whatsapp.com/channel/0029Vb6eoNkATRSqdUT76Y3Y" target="_blank" rel="noopener noreferrer" class="social-button whatsapp">
                            <i class="fab fa-whatsapp social-icon"></i>
                            WhatsApp
                        </a>
                        <a href="https://t.me/parialliance" target="_blank" rel="noopener noreferrer" class="social-button telegram">
                            <i class="fab fa-telegram social-icon"></i>
                            Telegram
                        </a>
                        <a href="https://youtube.com/@parialliance?si=MMQ8MwI-XZNK7SiG" target="_blank" rel="noopener noreferrer" class="social-button youtube">
                            <i class="fab fa-youtube social-icon"></i>
                            YouTube
                        </a>
                    </div>
                    
                    <button id="logout-btn" class="button">Se déconnecter</button>
                    <button id="delete-account-btn" class="button danger" style="margin-top: 15px;">Supprimer mon compte</button>
                </div>
            </div>
        </div>

        <!-- Events Section -->
        <div id="events-section" class="section">
            <div id="events-list" style="height: 100%; overflow-y: auto; padding: 10px;">
                <div class="empty-state">
                    <i class="fas fa-bell"></i>
                    <div class="empty-state-title">Aucun événement</div>
                    <div class="empty-state-text">Les événements apparaîtront ici</div>
                </div>
            </div>
        </div>

        <!-- Interface Section -->
        <div id="interface-section" class="section">
            <div class="interface-sections">
                <div class="interface-section">
                    <div class="interface-title">
                        <i class="fas fa-palette"></i>
                        Thème de couleur
                    </div>
                    <div class="interface-subtitle">
                        Personnalisez l'apparence de l'application avec une large gamme de couleurs
                    </div>
                    <div class="theme-selector">
                        <div class="theme-option theme-blue active" data-theme="default">
                            <div class="theme-label">Bleu</div>
                        </div>
                        <div class="theme-option theme-green" data-theme="green">
                            <div class="theme-label">Vert</div>
                        </div>
                        <div class="theme-option theme-red" data-theme="red">
                            <div class="theme-label">Rouge</div>
                        </div>
                        <div class="theme-option theme-orange" data-theme="orange">
                            <div class="theme-label">Orange</div>
                        </div>
                        <div class="theme-option theme-purple" data-theme="purple">
                            <div class="theme-label">Violet</div>
                        </div>
                        <div class="theme-option theme-teal" data-theme="teal">
                            <div class="theme-label">Turquoise</div>
                        </div>
                        <div class="theme-option theme-indigo" data-theme="indigo">
                            <div class="theme-label">Indigo</div>
                        </div>
                        <div class="theme-option theme-pink" data-theme="pink">
                            <div class="theme-label">Rose</div>
                        </div>
                        <div class="theme-option theme-cyan" data-theme="cyan">
                            <div class="theme-label">Cyan</div>
                        </div>
                        <div class="theme-option theme-lime" data-theme="lime">
                            <div class="theme-label">Lime</div>
                        </div>
                        <div class="theme-option theme-amber" data-theme="amber">
                            <div class="theme-label">Ambre</div>
                        </div>
                        <div class="theme-option theme-deep-orange" data-theme="deep-orange">
                            <div class="theme-label">Orange Foncé</div>
                        </div>
                    </div>
                </div>
                
                <div class="interface-section">
                    <div class="interface-title">
                        <i class="fas fa-moon"></i>
                        Mode d'affichage
                    </div>
                    <div class="interface-subtitle">
                        Basculer entre le mode clair et sombre selon vos préférences
                    </div>
                    <div class="setting-item">
                        <div class="setting-row">
                            <div class="setting-icon">
                                <i class="fas fa-moon" style="color: var(--primary-color);"></i>
                            </div>
                            <div class="setting-label">Mode sombre</div>
                        </div>
                        <label class="switch">
                            <input type="checkbox" id="dark-toggle">
                            <span class="slider"></span>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- History Section -->
        <div id="history-section" class="section">
            <div style="height: 100%; overflow-y: auto; padding: 10px 0;">
                <div id="history-content">
                    <!-- History content will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Forecast Detail Page - Restructured and Fixed -->
    <div class="forecast-detail" id="forecast-detail">
        <div class="header">
            <div class="header-left">
                <button class="back-btn" id="detail-back-btn">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div class="header-title" id="detail-header-title">Détails du pronostic</div>
            </div>
            <div class="header-actions">
                <button class="action-btn" id="favorite-btn">
                    <i class="fas fa-star"></i>
                </button>
            </div>
        </div>

        <!-- Fixed header section with teams -->
        <div class="forecast-info-section">
            <div class="league-info" id="detail-league">Ligue 1 • Journée 16</div>
            
            <div class="detail-teams">
                <div class="detail-team">
                    <div class="detail-team-logo" id="detail-home-logo">
                        <i class="fas fa-futbol"></i>
                    </div>
                    <div class="detail-team-name" id="detail-home-team">Équipe Domicile</div>
                </div>
                
                <div class="detail-prediction">
                    <div class="detail-prediction-value" id="detail-prediction" style="display: none;">1X</div>
                    <div class="detail-forecast-status status-pending" id="detail-status">À venir</div>
                    <div class="detail-forecast-time" id="detail-time">29.06.2025 10:30</div>
                </div>
                
                <div class="detail-team">
                    <div class="detail-team-logo" id="detail-away-logo">
                        <i class="fas fa-futbol"></i>
                    </div>
                    <div class="detail-team-name" id="detail-away-team">Équipe Extérieur</div>
                </div>
            </div>
        </div>

        <!-- Scrollable content area -->
        <div class="detail-scrollable-content">
            <!-- Tabs -->
            <div class="detail-tabs">
                <div class="detail-tab active" data-tab="prediction">Prédiction</div>
                <div class="detail-tab" data-tab="analysis">Analyse IA</div>
                <div class="detail-tab" data-tab="prob">Probabilités</div>
                <div class="detail-tab" data-tab="scores">Scores</div>
            </div>

            <!-- Tab Contents -->
            <div class="tab-content active" id="prediction-content">
                <div class="analysis-section">
                    <div class="analysis-title">Prédiction recommandée</div>
                    <div class="analysis-content" id="prediction-analysis">
                        Cette prédiction est basée sur une analyse approfondie des données historiques, 
                        de la forme récente des équipes et des statistiques avancées.
                    </div>
                </div>

                <div class="confidence-info" id="detail-confidence-text">
                    Confiance: 75%
                </div>

                <div class="analysis-section">
                    <div class="analysis-title">Facteurs clés</div>
                    <div class="analysis-content" id="key-factors">
                        • Forme récente des équipes<br>
                        • Historique des confrontations<br>
                        • Statistiques offensives et défensives<br>
                        • Conditions de jeu
                    </div>
                </div>
            </div>

            <div class="tab-content" id="analysis-content">
                <div class="analysis-section">
                    <div class="analysis-title">Analyse de l'IA</div>
                    <div class="analysis-content" id="ai-analysis-content">
                        Analyse en cours de chargement...
                    </div>
                </div>
            </div>

            <div class="tab-content" id="prob-content">
                <div class="probability-item">
                    <div class="probability-label">Victoire Domicile</div>
                    <div class="probability-value">35%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Match Nul</div>
                    <div class="probability-value">28%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Victoire Extérieur</div>
                    <div class="probability-value">37%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Plus de 1.5 buts</div>
                    <div class="probability-value">65%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Plus de 2.5 buts</div>
                    <div class="probability-value">65%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Moins de 3.5 buts</div>
                    <div class="probability-value">65%</div>
                </div>
                <div class="probability-item">
                    <div class="probability-label">Les deux équipes marquent</div>
                    <div class="probability-value">72%</div>
                </div>
            </div>

            <div class="tab-content" id="scores-content">
                <h4 style="margin-bottom: 15px;">Scores les plus probables</h4>
                <div class="score-prediction">
                    <div class="score-item">
                        <div class="score-value">1-1</div>
                        <div class="score-probability">12.5%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">1-0</div>
                        <div class="score-probability">11.2%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">0-1</div>
                        <div class="score-probability">10.8%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">2-1</div>
                        <div class="score-probability">9.3%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">1-2</div>
                        <div class="score-probability">8.7%</div>
                    </div>
                    <div class="score-item">
                        <div class="score-value">2-0</div>
                        <div class="score-probability">7.9%</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <div class="bottom-nav" id="bottom-nav">
        <div class="nav-item active" data-section="forecasts">
            <i class="nav-icon fas fa-futbol"></i>
            <span>Simples</span>
        </div>
        <div class="nav-item" data-section="ai-forecasts">
            <i class="nav-icon fas fa-brain"></i>
            <span>Prédictions IA</span>
        </div>
        <div class="nav-item" data-section="profile">
            <i class="nav-icon fas fa-user"></i>
            <span>Profil</span>
        </div>
    </div>

    <!-- Confirmation Dialogs -->
    <div id="logout-confirmation" class="confirmation-dialog">
        <div class="confirmation-title">Se déconnecter ?</div>
        <div class="confirmation-text">Voulez-vous vraiment vous déconnecter de KING PRONOS ?</div>
        <div class="confirmation-buttons">
            <div class="confirmation-button confirmation-cancel" id="logout-cancel">Annuler</div>
            <div class="confirmation-button confirmation-confirm" id="logout-confirm">Déconnecter</div>
        </div>
    </div>

    <div id="delete-account-confirmation" class="confirmation-dialog">
        <div class="confirmation-title">Supprimer votre compte ?</div>
        <div class="confirmation-text">ATTENTION : Cette action est définitive et irréversible. Toutes vos données seront supprimées.</div>
        <div class="confirmation-buttons">
            <div class="confirmation-button confirmation-cancel" id="delete-account-cancel">Annuler</div>
            <div class="confirmation-button confirmation-delete" id="delete-account-confirm">Supprimer</div>
        </div>
    </div>

    <div id="overlay" class="overlay"></div>
    <div class="notification" id="notification"></div>

    <script type="module">
        // Import Firebase modules (keeping all a1 logic)
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged, deleteUser } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-auth.js";
        import { getFirestore, collection, doc, setDoc, getDoc, getDocs, query, orderBy, addDoc, onSnapshot, where, deleteDoc, serverTimestamp, updateDoc, arrayUnion, arrayRemove, limit, Timestamp } from "https://www.gstatic.com/firebasejs/11.7.3/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDTPLxUiA8lj82kqc6CyCPLQDITc0CtLUE",
            authDomain: "ichat-betai.firebaseapp.com",
            databaseURL: "https://ichat-betai-default-rtdb.firebaseio.com",
            projectId: "ichat-betai",
            storageBucket: "ichat-betai.appspot.com",
            messagingSenderId: "168337722600",
            appId: "1:168337722600:web:beb331f83cc4778c5b4d5d",
            measurementId: "G-STXPSZN7X8"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // Admin configuration
        const ADMIN_EMAILS = ['billionsjonnhy@gmail.com', 'louiskbn05@gmail.com'];

        // Avatar configuration
        const GITHUB_REPO_URL = 'https://raw.githubusercontent.com/PariALLIANCE/Test/main/';
        const AVATAR_OPTIONS = [
            { id: 'king1', name: 'King 1', url: GITHUB_REPO_URL + 'king1.png' },
            { id: 'king2', name: 'King 2', url: GITHUB_REPO_URL + 'King2.png' },
            { id: 'king3', name: 'King 3', url: GITHUB_REPO_URL + 'king3.png' },
            { id: 'king4', name: 'King 4', url: GITHUB_REPO_URL + 'king4.png' },
            { id: 'king5', name: 'King 5', url: GITHUB_REPO_URL + 'king5.png' },
            { id: 'king6', name: 'King 6', url: GITHUB_REPO_URL + 'king6.png' },
            { id: 'king7', name: 'King 7', url: GITHUB_REPO_URL + 'king7.png' }
        ];

        // Global variables (keeping all from a1)
        let isLoggedIn = false;
        let currentUser = null;
        let currentUserData = null;
        let isAdmin = false;
        let currentSection = 'forecasts';
        let currentForecastTab = 'ia-singles';
        let forecastsCache = {};
        let selectedForecast = null;
        let hasNewEvents = false;
        let lastViewedEventTimestamp = null;
        let eventsUnsubscribe = null;
        let selectedTheme = localStorage.getItem('kingPronosTheme') || 'default';
        let selectedAvatar = null;
        let tempSelectedAvatar = null;

        // Protection contre la copie
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });

        document.addEventListener('selectstart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('dragstart', function(e) {
            e.preventDefault();
        });

        document.addEventListener('copy', function(e) {
            e.preventDefault();
        });

        document.addEventListener('cut', function(e) {
            e.preventDefault();
        });

        document.addEventListener('paste', function(e) {
            e.preventDefault();
        });

        // Protection contre F12, Ctrl+Shift+I, etc.
        document.addEventListener('keydown', function(e) {
            if (e.key === 'F12' || 
                (e.ctrlKey && e.shiftKey && e.key === 'I') ||
                (e.ctrlKey && e.shiftKey && e.key === 'C') ||
                (e.ctrlKey && e.shiftKey && e.key === 'J') ||
                (e.ctrlKey && e.key === 'U') ||
                (e.ctrlKey && e.key === 'S') ||
                (e.ctrlKey && e.key === 'A') ||
                (e.ctrlKey && e.key === 'C') ||
                (e.ctrlKey && e.key === 'X') ||
                (e.ctrlKey && e.key === 'V')) {
                e.preventDefault();
                return false;
            }
        });

        // Initialize dark mode detection based on stored preference or system preference
        function initializeDarkMode() {
            const savedPreference = localStorage.getItem('kingPronosDarkMode');
            
            if (savedPreference === 'true') {
                document.documentElement.classList.add('dark');
            } else if (savedPreference === 'false') {
                document.documentElement.classList.remove('dark');
            } else {
                // No saved preference, check system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
        }

        // Initialize on page load
        initializeDarkMode();

        // Listen for system changes only when no user preference is saved
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (localStorage.getItem('kingPronosDarkMode') === null) {
                if (event.matches) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
            }
        });

        // Utility functions
        function showNotification(message, type = 'info') {
            const notification = document.getElementById('notification');
            if (!notification) return;
            
            notification.classList.remove('show');
            
            setTimeout(() => {
                notification.textContent = message;
                notification.className = 'notification ' + type;
                notification.classList.add('show');
                
                setTimeout(() => {
                    notification.classList.remove('show');
                    
                    setTimeout(() => {
                        notification.className = 'notification';
                        notification.textContent = '';
                    }, 300);
                }, 3000);
            }, 100);
        }

        // Info modal functions
        function showInfoModal(title, content) {
            document.getElementById('info-modal-title').textContent = title;
            document.getElementById('info-modal-text').innerHTML = content;
            document.getElementById('info-modal').classList.add('active');
        }

        function closeInfoModal() {
            document.getElementById('info-modal').classList.remove('active');
        }

        // Avatar functions
        function openAvatarViewer() {
            const modal = document.getElementById('avatar-viewer-modal');
            const viewerImage = document.getElementById('avatar-viewer-image');
            
            if (selectedAvatar) {
                const avatarData = AVATAR_OPTIONS.find(avatar => avatar.id === selectedAvatar);
                if (avatarData) {
                    viewerImage.src = avatarData.url;
                } else {
                    viewerImage.src = '';
                }
            } else {
                viewerImage.src = '';
            }
            
            modal.classList.add('active');
        }

        function closeAvatarViewer() {
            document.getElementById('avatar-viewer-modal').classList.remove('active');
        }

        function openAvatarSelector() {
            const modal = document.getElementById('avatar-selector-modal');
            const modalGrid = document.getElementById('avatar-modal-grid');
            
            modalGrid.innerHTML = '';
            tempSelectedAvatar = selectedAvatar;

            AVATAR_OPTIONS.forEach(avatar => {
                const avatarElement = document.createElement('div');
                avatarElement.className = 'avatar-modal-option';
                avatarElement.dataset.avatarId = avatar.id;
                
                if (selectedAvatar === avatar.id) {
                    avatarElement.classList.add('active');
                }

                const img = document.createElement('img');
                img.src = avatar.url;
                img.alt = avatar.name;
                img.onerror = function() {
                    avatarElement.innerHTML = '<div class="avatar-loading"><i class="fas fa-user"></i></div>';
                };

                avatarElement.appendChild(img);
                avatarElement.addEventListener('click', () => selectTempAvatar(avatar.id));
                modalGrid.appendChild(avatarElement);
            });

            modal.classList.add('active');
            updateSaveButton();
        }

        function selectTempAvatar(avatarId) {
            tempSelectedAvatar = avatarId;
            
            document.querySelectorAll('.avatar-modal-option').forEach(option => {
                option.classList.remove('active');
            });
            
            const selectedOption = document.querySelector(`.avatar-modal-option[data-avatar-id="${avatarId}"]`);
            if (selectedOption) {
                selectedOption.classList.add('active');
            }
            
            updateSaveButton();
        }

        function updateSaveButton() {
            const saveButton = document.getElementById('avatar-modal-save');
            saveButton.disabled = !tempSelectedAvatar || tempSelectedAvatar === selectedAvatar;
        }

        async function saveSelectedAvatar() {
            if (!tempSelectedAvatar || !currentUser) return;

            try {
                // Update in Firestore
                await updateDoc(doc(db, "Users", currentUser.uid), {
                    avatar: tempSelectedAvatar,
                    updatedAt: serverTimestamp()
                });

                // Update local state
                selectedAvatar = tempSelectedAvatar;
                currentUserData.avatar = tempSelectedAvatar;

                // Update UI
                updateProfileAvatar();
                closeAvatarSelector();
                closeAvatarViewer();

                showNotification("Avatar mis à jour avec succès!", "success");

            } catch (error) {
                console.error('Erreur lors de la sauvegarde de l\'avatar:', error);
                showNotification("Erreur lors de la sauvegarde de l'avatar", "error");
            }
        }

        function closeAvatarSelector() {
            document.getElementById('avatar-selector-modal').classList.remove('active');
            tempSelectedAvatar = null;
        }

        function updateProfileAvatar() {
            const profilePic = document.getElementById('profile-pic');
            
            if (selectedAvatar) {
                const avatarData = AVATAR_OPTIONS.find(avatar => avatar.id === selectedAvatar);
                if (avatarData) {
                    profilePic.innerHTML = '';
                    const img = document.createElement('img');
                    img.src = avatarData.url;
                    img.alt = avatarData.name;
                    img.onerror = function() {
                        profilePic.innerHTML = '<i class="fas fa-user"></i>';
                    };
                    profilePic.appendChild(img);
                }
            } else {
                profilePic.innerHTML = '<i class="fas fa-user"></i>';
            }
        }

        // Setup theme functions
        function setupTheme() {
            const themeClasses = ['theme-green', 'theme-red', 'theme-orange', 'theme-purple', 'theme-teal', 'theme-indigo', 'theme-pink', 'theme-cyan', 'theme-lime', 'theme-amber', 'theme-deep-orange'];
            
            document.documentElement.classList.remove(...themeClasses);
            
            if (selectedTheme !== 'default') {
                document.documentElement.classList.add(`theme-${selectedTheme}`);
            }
            
            document.querySelectorAll('.theme-option').forEach(option => {
                option.classList.remove('active');
            });
            
            const activeThemeOption = document.querySelector(`.theme-option[data-theme="${selectedTheme}"]`);
            if (activeThemeOption) {
                activeThemeOption.classList.add('active');
            }
        }

        function setupDarkMode() {
            const savedPreference = localStorage.getItem('kingPronosDarkMode');
            
            if (savedPreference === 'true') {
                document.documentElement.classList.add('dark');
                document.getElementById('dark-toggle').checked = true;
            } else if (savedPreference === 'false') {
                document.documentElement.classList.remove('dark');
                document.getElementById('dark-toggle').checked = false;
            } else {
                // Use system preference
                if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                    document.documentElement.classList.add('dark');
                    document.getElementById('dark-toggle').checked = true;
                } else {
                    document.documentElement.classList.remove('dark');
                    document.getElementById('dark-toggle').checked = false;
                }
            }
        }

        // Function to get current date in YYYY-MM-DD format
        function getCurrentDateString() {
            return new Date().toISOString().slice(0, 10);
        }

        // Function to get previous date string
        function getDateString(daysAgo = 0) {
            const date = new Date();
            date.setDate(date.getDate() - daysAgo);
            return date.toISOString().slice(0, 10);
        }

        // Function to get forecast file URL for a specific date
        function getForecastFileUrl(dateString) {
            return `https://raw.githubusercontent.com/Jonnhy2255/Pronosoftbot/main/prédiction-${dateString}-analyse-ia.json`;
        }

        // Function to fetch forecasts from GitHub for a specific date
        async function fetchForecastsFromGitHub(dateString) {
            const fileUrl = getForecastFileUrl(dateString);
            
            try {
                console.log(`Récupération des pronostics pour ${dateString}: ${fileUrl}`);
                
                const response = await fetch(fileUrl);
                
                if (!response.ok) {
                    if (response.status === 404) {
                        console.log(`Fichier de pronostics non trouvé pour ${dateString}`);
                        return null;
                    }
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log(`Pronostics récupérés avec succès pour ${dateString}`);
                
                return data;
            } catch (error) {
                console.error(`Erreur lors de la récupération des pronostics pour ${dateString}: ${error.message}`);
                return null;
            }
        }

        // Function to process and categorize forecasts - updated for new JSON structure
        function processForecastData(data) {
            const processed = {
                'ia-singles': [],
                safes: [],
                simple: []
            };

            if (!data) {
                return processed;
            }

            // Traiter les "Singles Premium" depuis ia_singles_premium.details
            if (data.ia_singles_premium && data.ia_singles_premium.details) {
                data.ia_singles_premium.details.forEach(forecast => {
                    processed['ia-singles'].push({
                        id: forecast.id,
                        HomeTeam: forecast.HomeTeam,
                        AwayTeam: forecast.AwayTeam,
                        confidence: forecast.confidence,
                        date: forecast.date,
                        league: forecast.league,
                        country: forecast.country,
                        prediction: forecast.prediction,
                        type: 'single',
                        poisson_probabilities: forecast.poisson_probabilities,
                        poisson_top_scores: forecast.poisson_top_scores,
                        score_prediction: forecast.score_prediction,
                        logo_home: forecast.logo_home,
                        logo_away: forecast.logo_away,
                        analyse_ia: forecast.analyse_ia
                    });
                });
            }

            // Traiter les "safes" depuis recommandations.safest_bets
            if (data.recommandations && data.recommandations.safest_bets) {
                data.recommandations.safest_bets.forEach(forecast => {
                    processed.safes.push({
                        id: forecast.id,
                        HomeTeam: forecast.HomeTeam,
                        AwayTeam: forecast.AwayTeam,
                        confidence: forecast.confidence,
                        date: forecast.date,
                        league: forecast.league,
                        country: forecast.country,
                        prediction: forecast.prediction,
                        type: 'single',
                        poisson_probabilities: forecast.poisson_probabilities,
                        poisson_top_scores: forecast.poisson_top_scores,
                        score_prediction: forecast.score_prediction,
                        logo_home: forecast.logo_home,
                        logo_away: forecast.logo_away,
                        analyse_ia: forecast.analyse_ia
                    });
                });
            }

            // Traiter les pronostics simples depuis predictions_simples.details
            if (data.predictions_simples && data.predictions_simples.details) {
                data.predictions_simples.details.forEach(forecast => {
                    processed.simple.push({
                        id: forecast.id,
                        HomeTeam: forecast.HomeTeam,
                        AwayTeam: forecast.AwayTeam,
                        confidence: forecast.confidence,
                        date: forecast.date,
                        league: forecast.league,
                        country: forecast.country,
                        prediction: forecast.prediction,
                        type: 'single',
                        poisson_probabilities: forecast.poisson_probabilities,
                        poisson_top_scores: forecast.poisson_top_scores,
                        score_prediction: forecast.score_prediction,
                        logo_home: forecast.logo_home,
                        logo_away: forecast.logo_away,
                        analyse_ia: forecast.analyse_ia
                    });
                });
            }

            return processed;
        }

        // Function to parse French date format
        function parseFrenchDate(dateStr) {
            if (!dateStr) return null;
            
            try {
                // Handle format like "29 juin 2025 à 09:00:00 UTC"
                const frenchMonths = {
                    'janvier': '01', 'février': '02', 'mars': '03', 'avril': '04',
                    'mai': '05', 'juin': '06', 'juillet': '07', 'août': '08',
                    'septembre': '09', 'octobre': '10', 'novembre': '11', 'décembre': '12'
                };
                
                // Extract date and time parts
                const parts = dateStr.split(' à ');
                const datePart = parts[0]; // "29 juin 2025"
                const timePart = parts[1] || '00:00:00'; // "09:00:00 UTC"
                
                // Parse date part
                const dateComponents = datePart.split(' ');
                if (dateComponents.length >= 3) {
                    const day = dateComponents[0].padStart(2, '0');
                    const monthName = dateComponents[1].toLowerCase();
                    const year = dateComponents[2];
                    const month = frenchMonths[monthName] || '01';
                    
                    // Parse time part (remove UTC if present)
                    const time = timePart.replace(' UTC', '');
                    
                    // Create ISO string
                    const isoString = `${year}-${month}-${day}T${time}Z`;
                    return new Date(isoString);
                }
            } catch (error) {
                console.error('Error parsing French date:', dateStr, error);
            }
            
            // Fallback: try to parse as regular date
            return new Date(dateStr);
        }

        // Function to get team icons (fallback)
        function getTeamIcon(teamName) {
            const icons = ['fas fa-futbol', 'fas fa-shield-alt', 'fas fa-star', 'fas fa-trophy', 'fas fa-fire'];
            const hash = teamName ? teamName.split('').reduce((a, b) => (a + b.charCodeAt(0)) % icons.length, 0) : 0;
            return icons[hash];
        }

        // Function to create team logo element
        function createTeamLogoElement(logoUrl, teamName, isDetail = false) {
            const logoContainer = document.createElement('div');
            logoContainer.className = isDetail ? 'detail-team-logo' : 'team-logo';

            if (logoUrl) {
                const img = document.createElement('img');
                img.src = logoUrl;
                img.alt = teamName || 'Team Logo';
                img.onerror = function() {
                    // Si l'image ne charge pas, utiliser l'icône par défaut
                    logoContainer.innerHTML = `<i class="${getTeamIcon(teamName)}"></i>`;
                };
                logoContainer.appendChild(img);
            } else {
                // Pas de logo fourni, utiliser l'icône par défaut
                logoContainer.innerHTML = `<i class="${getTeamIcon(teamName)}"></i>`;
            }

            return logoContainer;
        }

        // Function to create forecast card
        function createForecastCard(forecastData) {
            const card = document.createElement('div');
            card.className = 'forecast-card';
            card.addEventListener('click', () => openForecastDetail(forecastData));

            let statusClass = 'pending';
            let statusText = 'À venir';
            
            if (forecastData.status === 'win') {
                statusClass = 'win';
                statusText = 'Gagné';
            } else if (forecastData.status === 'loss') {
                statusClass = 'loss';
                statusText = 'Perdu';
            }

            let formattedDate = 'Aujourd\'hui';
            try {
                if (forecastData.date) {
                    const matchDate = parseFrenchDate(forecastData.date);
                    if (matchDate && !isNaN(matchDate.getTime())) {
                        const today = new Date();
                        const diffTime = matchDate.getTime() - today.getTime();
                        const diffDays = Math.round(diffTime / (1000 * 60 * 60 * 24));
                        
                        if (diffDays === 0) {
                            formattedDate = 'Aujourd\'hui';
                        } else if (diffDays === 1) {
                            formattedDate = 'Demain';
                        } else if (diffDays === -1) {
                            formattedDate = 'Hier';
                        } else {
                            formattedDate = matchDate.toLocaleDateString('fr-FR', {
                                day: 'numeric',
                                month: 'short'
                            });
                        }
                    }
                }
            } catch (e) {
                formattedDate = 'Date inconnue';
            }

            // Single match layout avec juste les équipes et un "-" au centre
            card.innerHTML = `
                <div class="forecast-header">
                    <div class="league-info">${forecastData.league || 'Compétition'}</div>
                    <div class="forecast-status status-${statusClass}">${statusText}</div>
                </div>
                
                <div class="teams-container">
                    <div class="team">
                        <div class="team-logo-container"></div>
                        <div class="team-name">${forecastData.HomeTeam || 'Équipe 1'}</div>
                    </div>
                    
                    <div class="forecast-vs">
                        <div class="vs-text">-</div>
                    </div>
                    
                    <div class="team">
                        <div class="team-logo-container-away"></div>
                        <div class="team-name">${forecastData.AwayTeam || 'Équipe 2'}</div>
                    </div>
                </div>
                
                <div class="forecast-time">${formattedDate}</div>
            `;

            // Ajouter les logos après la création du HTML
            setTimeout(() => {
                const homeLogoContainer = card.querySelector('.team-logo-container');
                const awayLogoContainer = card.querySelector('.team-logo-container-away');
                
                if (homeLogoContainer) {
                    const homeLogo = createTeamLogoElement(forecastData.logo_home, forecastData.HomeTeam);
                    homeLogoContainer.replaceWith(homeLogo);
                }
                
                if (awayLogoContainer) {
                    const awayLogo = createTeamLogoElement(forecastData.logo_away, forecastData.AwayTeam);
                    awayLogoContainer.replaceWith(awayLogo);
                }
            }, 0);

            return card;
        }

        // Function to open forecast detail
        function openForecastDetail(forecastData) {
            selectedForecast = forecastData;
            
            // Update detail view
            document.getElementById('detail-league').textContent = forecastData.league || 'Compétition';
            
            document.getElementById('detail-home-team').textContent = forecastData.HomeTeam || 'Équipe 1';
            document.getElementById('detail-away-team').textContent = forecastData.AwayTeam || 'Équipe 2';
            // Hide prediction value for all forecasts as requested
            document.getElementById('detail-prediction').style.display = 'none';
            
            // Mettre à jour les logos dans la vue détaillée
            const detailHomeLogo = document.getElementById('detail-home-logo');
            const detailAwayLogo = document.getElementById('detail-away-logo');
            
            // Logo équipe domicile
            detailHomeLogo.innerHTML = '';
            if (forecastData.logo_home) {
                const homeImg = document.createElement('img');
                homeImg.src = forecastData.logo_home;
                homeImg.alt = forecastData.HomeTeam || 'Home Team';
                homeImg.style.width = '100%';
                homeImg.style.height = '100%';
                homeImg.style.objectFit = 'cover';
                homeImg.style.borderRadius = '50%';
                homeImg.onerror = function() {
                    detailHomeLogo.innerHTML = `<i class="${getTeamIcon(forecastData.HomeTeam)}"></i>`;
                };
                detailHomeLogo.appendChild(homeImg);
            } else {
                detailHomeLogo.innerHTML = `<i class="${getTeamIcon(forecastData.HomeTeam)}"></i>`;
            }
            
            // Logo équipe extérieur
            detailAwayLogo.innerHTML = '';
            if (forecastData.logo_away) {
                const awayImg = document.createElement('img');
                awayImg.src = forecastData.logo_away;
                awayImg.alt = forecastData.AwayTeam || 'Away Team';
                awayImg.style.width = '100%';
                awayImg.style.height = '100%';
                awayImg.style.objectFit = 'cover';
                awayImg.style.borderRadius = '50%';
                awayImg.onerror = function() {
                    detailAwayLogo.innerHTML = `<i class="${getTeamIcon(forecastData.AwayTeam)}"></i>`;
                };
                detailAwayLogo.appendChild(awayImg);
            } else {
                detailAwayLogo.innerHTML = `<i class="${getTeamIcon(forecastData.AwayTeam)}"></i>`;
            }
            
            let statusClass = 'pending';
            let statusText = 'À venir';
            
            if (forecastData.status === 'win') {
                statusClass = 'win';
                statusText = 'Gagné';
            } else if (forecastData.status === 'loss') {
                statusClass = 'loss';
                statusText = 'Perdu';
            }
            
            document.getElementById('detail-status').textContent = statusText;
            document.getElementById('detail-status').className = `detail-forecast-status status-${statusClass}`;
            
            let formattedDateTime = 'Aujourd\'hui';
            try {
                if (forecastData.date) {
                    const matchDate = parseFrenchDate(forecastData.date);
                    if (matchDate && !isNaN(matchDate.getTime())) {
                        formattedDateTime = matchDate.toLocaleDateString('fr-FR', {
                            day: 'numeric',
                            month: 'short',
                            year: 'numeric',
                            hour: '2-digit',
                            minute: '2-digit'
                        });
                    }
                }
            } catch (e) {
                formattedDateTime = 'Date inconnue';
            }
            
            document.getElementById('detail-time').textContent = formattedDateTime;

            // Update analysis content avec prédiction colorée
            document.getElementById('prediction-analysis').innerHTML = `
                <strong>Prédiction recommandée:</strong> <span class="prediction-highlight">${forecastData.prediction || 'N/A'}</span><br><br>
                Cette prédiction est basée sur l'analyse des performances récentes, des statistiques historiques 
                et des facteurs contextuels des équipes ${forecastData.HomeTeam || 'Équipe 1'} et ${forecastData.AwayTeam || 'Équipe 2'}.
                ${forecastData.score_prediction ? `<br><br><strong>Score prédit:</strong> ${forecastData.score_prediction}` : ''}
            `;

            // Update confidence - remplacé par le style confidence-info
            const confidence = forecastData.confidence || 0;
            document.getElementById('detail-confidence-text').textContent = `Confiance: ${confidence}%`;

            // Update AI analysis
            const aiAnalysisContent = document.getElementById('ai-analysis-content');
            if (forecastData.analyse_ia) {
                aiAnalysisContent.innerHTML = forecastData.analyse_ia;
            } else {
                aiAnalysisContent.innerHTML = `
                    <div style="text-align: center; padding: 40px 20px; color: var(--inactive-text);">
                        <i class="fas fa-robot" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
                        <h3 style="margin-bottom: 10px;">Analyse IA</h3>
                        <p>Analyse non disponible pour ce pronostic</p>
                    </div>
                `;
            }

            // Update probabilities
            if (forecastData.poisson_probabilities) {
                document.getElementById('prob-content').innerHTML = `
                    <div class="probability-item">
                        <div class="probability-label">Victoire ${forecastData.HomeTeam || 'Domicile'}</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.win1 || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Match Nul</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.draw || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Victoire ${forecastData.AwayTeam || 'Extérieur'}</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.win2 || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Plus de 1.5 buts</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.over15 || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Plus de 2.5 buts</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.over25 || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Moins de 3.5 buts</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.under35 || 0).toFixed(1)}%</div>
                    </div>
                    <div class="probability-item">
                        <div class="probability-label">Les deux équipes marquent</div>
                        <div class="probability-value">${parseFloat(forecastData.poisson_probabilities.btts || 0).toFixed(1)}%</div>
                    </div>
                `;
            }

            // Update scores
            if (forecastData.poisson_top_scores && forecastData.poisson_top_scores.length > 0) {
                const scoresHtml = forecastData.poisson_top_scores.map(scoreData => {
                    // Extraire seulement le score (ex: "1-3" de "Albirex Niigata 1-3 Machida Zelvia")
                    const scoreMatch = scoreData.score.match(/(\d+)-(\d+)/);
                    const simpleScore = scoreMatch ? `${scoreMatch[1]}-${scoreMatch[2]}` : scoreData.score;
                    
                    return `
                        <div class="score-item">
                            <div class="score-value">${simpleScore}</div>
                            <div class="score-probability">${parseFloat(scoreData.probability || 0).toFixed(1)}%</div>
                        </div>
                    `;
                }).join('');

                document.getElementById('scores-content').innerHTML = `
                    <h4 style="margin-bottom: 15px;">Scores les plus probables</h4>
                    <div class="score-prediction">
                        ${scoresHtml}
                    </div>
                `;
            }

            // Show detail view
            document.getElementById('forecast-detail').classList.add('active');
        }

        // Function to close forecast detail
        function closeForecastDetail() {
            document.getElementById('forecast-detail').classList.remove('active');
            selectedForecast = null;
        }

        // Function to switch tabs in detail view
        function switchDetailTab(tabId) {
            // Update tab buttons
            document.querySelectorAll('.detail-tab').forEach(tab => {
                if (tab.dataset.tab === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });

            // Update tab content
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            document.getElementById(`${tabId}-content`).classList.add('active');
        }

        // Function to load forecasts data
        async function loadForecastsData(tabType) {
            if (forecastsCache[tabType]) {
                displayForecastsFromCache(tabType);
                return;
            }
            
            let listElement;
            if (currentSection === 'ai-forecasts') {
                listElement = document.getElementById(`${tabType}-list`);
            } else {
                listElement = document.getElementById('forecasts-container');
            }
            
            if (!listElement) return;
            
            listElement.innerHTML = `
                <div class="loading-state">
                    <i class="fas fa-futbol loading-spinner"></i>
                    <h3>Chargement...</h3>
                    <p>Veuillez patienter</p>
                </div>
            `;
            
            try {
                // Fetch forecasts from GitHub
                const githubData = await fetchForecastsFromGitHub(getCurrentDateString());
                
                if (!githubData) {
                    listElement.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-calendar-day"></i>
                            <h3>Aucune prédiction fiable pour cette section</h3>
                            <p>Aucun pronostic disponible pour aujourd'hui</p>
                        </div>
                    `;
                    return;
                }
                
                // Process and categorize the data
                const processedData = processForecastData(githubData);
                
                // Cache the processed data
                Object.keys(processedData).forEach(type => {
                    forecastsCache[type] = processedData[type];
                });
                
                if (currentSection === 'ai-forecasts') {
                    displayForecastsFromCache(tabType);
                } else {
                    displayForecastsFromCache('simple');
                }
                
            } catch (error) {
                console.error(`Erreur chargement pronostics: ${error.message}`);
                listElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-circle"></i>
                        <h3>Erreur de chargement</h3>
                        <p>Impossible de charger les pronostics</p>
                    </div>
                `;
            }
        }

        // Function to display forecasts from cache
        function displayForecastsFromCache(tabType) {
            let listElement;
            if (currentSection === 'ai-forecasts') {
                listElement = document.getElementById(`${tabType}-list`);
            } else {
                listElement = document.getElementById('forecasts-container');
            }
            
            if (!listElement || !forecastsCache[tabType]) return;
            
            listElement.innerHTML = '';
            
            const forecasts = forecastsCache[tabType];
            
            if (forecasts.length === 0) {
                listElement.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-futbol"></i>
                        <h3>Aucune prédiction fiable pour cette section</h3>
                        <p>Aucun pronostic disponible pour cette catégorie</p>
                    </div>
                `;
                return;
            }
            
            const fragment = document.createDocumentFragment();
            
            forecasts.forEach((forecastData) => {
                const forecastElement = createForecastCard(forecastData);
                fragment.appendChild(forecastElement);
            });
            
            listElement.appendChild(fragment);
        }

        // Navigation functions
        function showSection(sectionId) {
            currentSection = sectionId;
            
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId + '-section').classList.add('active');
            
            // Update navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                if (item.dataset.section === sectionId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
            
            // Update header based on section
            updateHeaderForSection(sectionId);
            
            // Load data for section
            if (sectionId === 'forecasts') {
                loadForecastsData('simple');
            } else if (sectionId === 'ai-forecasts') {
                loadForecastsData(currentForecastTab);
            } else if (sectionId === 'events') {
                loadEvents();
            } else if (sectionId === 'history') {
                loadHistoryData();
            } else if (sectionId === 'interface') {
                setupTheme();
                setupDarkMode();
            } else if (sectionId === 'profile') {
                // No need to load avatar grid in profile
            }
        }

        function updateHeaderForSection(sectionId) {
            const backBtn = document.getElementById('back-btn');
            const menuBtn = document.getElementById('menu-btn');
            const headerTitle = document.getElementById('header-title');
            const headerActions = document.querySelector('.header-actions');
            
            // Reset header state
            backBtn.style.display = 'none';
            menuBtn.style.display = 'block';
            
            // Update based on section
            if (sectionId === 'forecasts') {
                headerTitle.textContent = 'Simples';
                headerActions.innerHTML = `
                    <button class="action-btn" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="action-btn" id="events-btn">
                        <i class="fas fa-bell"></i>
                        <div class="notification-dot" id="events-notification-dot"></div>
                    </button>
                `;
            } else if (sectionId === 'ai-forecasts') {
                headerTitle.textContent = 'Prédictions IA';
                headerActions.innerHTML = `
                    <button class="action-btn" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                    <button class="action-btn" id="events-btn">
                        <i class="fas fa-bell"></i>
                        <div class="notification-dot" id="events-notification-dot"></div>
                    </button>
                `;
            } else if (sectionId === 'profile') {
                headerTitle.textContent = 'Profil';
                headerActions.innerHTML = `
                    <button class="action-btn" id="events-btn">
                        <i class="fas fa-bell"></i>
                        <div class="notification-dot" id="events-notification-dot"></div>
                    </button>
                `;
            } else if (sectionId === 'events') {
                headerTitle.textContent = 'Événements';
                headerActions.innerHTML = `
                    <button class="action-btn" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                `;
                backBtn.style.display = 'block';
                menuBtn.style.display = 'none';
            } else if (sectionId === 'history') {
                headerTitle.textContent = 'Historique';
                headerActions.innerHTML = `
                    <button class="action-btn" id="search-btn">
                        <i class="fas fa-search"></i>
                    </button>
                `;
                backBtn.style.display = 'block';
                menuBtn.style.display = 'none';
            } else if (sectionId === 'interface') {
                headerTitle.textContent = 'Interface';
                headerActions.innerHTML = '';
                backBtn.style.display = 'block';
                menuBtn.style.display = 'none';
            }
            
            // Re-attach event listeners for new buttons
            const searchBtn = document.getElementById('search-btn');
            const eventsBtn = document.getElementById('events-btn');
            
            if (searchBtn) {
                searchBtn.addEventListener('click', () => {
                    showNotification("Fonction de recherche non implémentée", "info");
                });
            }
            
            if (eventsBtn) {
                eventsBtn.addEventListener('click', () => {
                    showSection('events');
                    updateLastViewedEventTimestamp();
                    hideEventNotificationDot();
                });
            }
            
            // Update notification dot if needed
            if (hasNewEvents) {
                const dot = document.getElementById('events-notification-dot');
                if (dot) dot.classList.add('active');
            }
        }

        function switchAIForecastTab(tabId) {
            currentForecastTab = tabId;
            
            document.querySelectorAll('.ai-forecast-tab').forEach(tab => {
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                } else {
                    tab.classList.remove('active');
                }
            });
            
            document.querySelectorAll('.ai-forecasts-content').forEach(content => {
                if (content.id === `${tabId}-content`) {
                    content.classList.add('active');
                } else {
                    content.classList.remove('active');
                }
            });
            
            loadForecastsData(tabId);
        }

        // Events functions
        function showEventNotificationDot() {
            hasNewEvents = true;
            const dots = document.querySelectorAll('#events-notification-dot');
            dots.forEach(dot => {
                if (dot) dot.classList.add('active');
            });
        }
        
        function hideEventNotificationDot() {
            hasNewEvents = false;
            const dots = document.querySelectorAll('#events-notification-dot');
            dots.forEach(dot => {
                if (dot) dot.classList.remove('active');
            });
        }
        
        function updateLastViewedEventTimestamp() {
            lastViewedEventTimestamp = new Date();
            localStorage.setItem('kingPronosLastViewedEvent', lastViewedEventTimestamp.toISOString());
        }

        async function loadEvents() {
            const eventsList = document.getElementById('events-list');
            
            try {
                const eventsQuery = query(
                    collection(db, "Events"),
                    orderBy("timestamp", "desc"),
                    limit(50)
                );
                
                const eventsSnapshot = await getDocs(eventsQuery);
                
                eventsList.innerHTML = '';
                
                if (eventsSnapshot.empty) {
                    eventsList.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-bell"></i>
                            <div class="empty-state-title">Aucun événement</div>
                            <div class="empty-state-text">Les événements apparaîtront ici</div>
                        </div>
                    `;
                    return;
                }
                
                const eventElements = [];
                
                eventsSnapshot.docs.forEach(doc => {
                    const eventData = doc.data();
                    const eventElement = createEventElement(doc.id, eventData);
                    eventElements.push(eventElement);
                });
                
                eventElements.forEach(element => {
                    eventsList.appendChild(element);
                });
                
                console.log(`${eventsSnapshot.size} événements chargés`);
                
            } catch (error) {
                console.error('Erreur chargement événements:', error);
                eventsList.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-circle"></i>
                        <div class="empty-state-title">Erreur de chargement</div>
                        <div class="empty-state-text">Impossible de charger les événements</div>
                    </div>
                `;
            }
        }

        function createEventElement(eventId, eventData) {
            const eventElement = document.createElement('div');
            eventElement.className = 'admin-notification';
            
            let iconClass = 'fas fa-info-circle';
            if (eventData.type === 'alert') {
                iconClass = 'fas fa-exclamation-triangle';
            } else if (eventData.type === 'update') {
                iconClass = 'fas fa-sync-alt';
            }
            
            let timestamp = '';
            if (eventData.timestamp) {
                const eventDate = eventData.timestamp.toDate ? eventData.timestamp.toDate() : new Date(eventData.timestamp);
                timestamp = eventDate.toLocaleDateString('fr-FR', {
                    day: 'numeric',
                    month: 'short',
                    hour: '2-digit',
                    minute: '2-digit'
                });
            }
            
            eventElement.innerHTML = `
                <div class="admin-notification-header">
                    <div class="admin-notification-title">
                        <i class="${iconClass}"></i>
                        ${eventData.title || 'Notification'}
                    </div>
                </div>
                <div class="admin-notification-content">${eventData.content || ''}</div>
                <div class="admin-notification-footer">
                    ${timestamp}
                    ${eventData.senderName ? ' • ' + eventData.senderName : ''}
                </div>
            `;
            
            return eventElement;
        }

        async function loadHistoryData() {
            const historyContent = document.getElementById('history-content');
            
            historyContent.innerHTML = `
                <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; height: 200px;">
                    <i class="fas fa-spinner fa-spin" style="font-size: 30px; color: var(--primary-color);"></i>
                    <div style="margin-top: 10px; font-weight: bold;">Chargement...</div>
                </div>
            `;

            try {
                // Charger seulement les données d'hier et d'avant-hier
                const yesterday = getDateString(1);
                const dayBeforeYesterday = getDateString(2);
                
                // Fetch data for yesterday and day before yesterday
                const [yesterdayData, dayBeforeYesterdayData] = await Promise.all([
                    fetchForecastsFromGitHub(yesterday),
                    fetchForecastsFromGitHub(dayBeforeYesterday)
                ]);

                // Process the data
                const yesterdayProcessed = processForecastData(yesterdayData);
                const dayBeforeYesterdayProcessed = processForecastData(dayBeforeYesterdayData);

                // Display the history
                displayHistoryData(yesterdayProcessed, dayBeforeYesterdayProcessed);

            } catch (error) {
                console.error(`Erreur chargement historique: ${error.message}`);
                historyContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-exclamation-circle"></i>
                        <div class="empty-state-title">Erreur de chargement</div>
                        <div class="empty-state-text">Impossible de charger l'historique des pronostics</div>
                    </div>
                `;
            }
        }

        function displayHistoryData(yesterdayData, dayBeforeYesterdayData) {
            const historyContent = document.getElementById('history-content');
            historyContent.innerHTML = '';

            const yesterday = new Date();
            yesterday.setDate(yesterday.getDate() - 1);
            
            const dayBeforeYesterday = new Date();
            dayBeforeYesterday.setDate(dayBeforeYesterday.getDate() - 2);

            // Display yesterday's data
            if (yesterdayData && Object.values(yesterdayData).some(arr => arr.length > 0)) {
                historyContent.appendChild(createHistoryDateSection(yesterday, yesterdayData));
            }

            // Display day before yesterday's data
            if (dayBeforeYesterdayData && Object.values(dayBeforeYesterdayData).some(arr => arr.length > 0)) {
                historyContent.appendChild(createHistoryDateSection(dayBeforeYesterday, dayBeforeYesterdayData));
            }

            // If no data available
            if (historyContent.children.length === 0) {
                historyContent.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-history"></i>
                        <div class="empty-state-title">Aucun historique</div>
                        <div class="empty-state-text">L'historique des pronostics des 2 derniers jours apparaîtra ici</div>
                    </div>
                `;
            }
        }

        function createHistoryDateSection(date, data) {
            const section = document.createElement('div');
            
            const dateHeader = document.createElement('div');
            dateHeader.className = 'history-date-header';
            dateHeader.textContent = date.toLocaleDateString('fr-FR', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            section.appendChild(dateHeader);

            // Display each category - removed "combines"
            const categories = [
                { key: 'simple', title: 'Pronostics Simples' },
                { key: 'ia-singles', title: 'Singles Premium' },
                { key: 'safes', title: 'Pronostics Safes' }
            ];

            categories.forEach(category => {
                if (data[category.key] && data[category.key].length > 0) {
                    const categorySection = document.createElement('div');
                    categorySection.className = 'history-category-section';

                    const categoryTitle = document.createElement('div');
                    categoryTitle.className = 'history-category-title';
                    categoryTitle.textContent = `${category.title} (${data[category.key].length})`;
                    categorySection.appendChild(categoryTitle);

                    const forecastsList = document.createElement('div');
                    forecastsList.className = 'history-forecasts-list';

                    data[category.key].forEach(forecast => {
                        const historyItem = createHistoryForecastElement(forecast);
                        forecastsList.appendChild(historyItem);
                    });

                    categorySection.appendChild(forecastsList);
                    section.appendChild(categorySection);
                }
            });

            return section;
        }

        function createHistoryForecastElement(forecastData) {
            const element = document.createElement('div');
            element.className = 'history-forecast-item';

            const content = `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                    <div style="font-weight: bold;">${forecastData.HomeTeam || 'Équipe 1'} vs ${forecastData.AwayTeam || 'Équipe 2'}</div>
                    <div class="forecast-status pending">À venir</div>
                </div>
                <div style="font-size: 11px; margin-top: 4px; opacity: 0.6;">
                    ${forecastData.league || 'Compétition'} • ${forecastData.country || 'Pays'}
                </div>
            `;

            element.innerHTML = content;
            return element;
        }

        // Auth functions (keeping from a1)
        function setupAuth() {
            const loginBtn = document.getElementById('loginBtn');
            const registerBtn = document.getElementById('registerBtn');
            const loginTab = document.getElementById('login-tab');
            const registerTab = document.getElementById('register-tab');
            const gotoRegister = document.getElementById('goto-register');
            const gotoLogin = document.getElementById('goto-login');
            
            loginBtn.addEventListener('click', loginUser);
            registerBtn.addEventListener('click', registerUser);
            
            loginTab.addEventListener('click', () => switchAuthTab('login'));
            registerTab.addEventListener('click', () => switchAuthTab('login'));
            gotoRegister.addEventListener('click', (e) => {
                e.preventDefault();
                switchAuthTab('register');
            });
            gotoLogin.addEventListener('click', (e) => {
                e.preventDefault();
                switchAuthTab('login');
            });
            
            onAuthStateChanged(auth, async (user) => {
                if (user) {
                    currentUser = user;
                    isLoggedIn = true;
                    
                    try {
                        await loadUserData();
                        showMainApp();
                        
                        console.log(`Utilisateur connecté: ${user.email}`);
                        
                    } catch (error) {
                        console.error(`Erreur initialisation: ${error.message}`);
                        showNotification("Erreur lors de l'initialisation", "error");
                    }
                } else {
                    isLoggedIn = false;
                    currentUser = null;
                    currentUserData = null;
                    isAdmin = false;
                    showAuthScreen();
                }
                
                hideLoading();
            });
        }

        function switchAuthTab(tab) {
            const loginForm = document.getElementById('login-form');
            const registerForm = document.getElementById('register-form');
            const loginTab = document.getElementById('login-tab');
            const registerTab = document.getElementById('register-tab');
            
            if (tab === 'register') {
                loginForm.classList.remove('active');
                registerForm.classList.add('active');
                loginTab.classList.remove('active');
                registerTab.classList.add('active');
            } else {
                registerForm.classList.remove('active');
                loginForm.classList.add('active');
                registerTab.classList.remove('active');
                loginTab.classList.add('active');
            }
            
            clearAuthErrors();
        }

        function clearAuthErrors() {
            document.querySelectorAll('.form-error').forEach(error => {
                error.style.display = 'none';
            });
            document.querySelectorAll('.log-message').forEach(log => {
                log.style.display = 'none';
            });
        }

        async function loginUser() {
            const email = document.getElementById('login-email').value.trim();
            const password = document.getElementById('login-password').value;
            const button = document.getElementById('loginBtn');
            const logElement = document.getElementById('login-log');
            
            clearAuthErrors();
            
            let hasError = false;
            
            if (!email || !email.includes('@')) {
                document.getElementById('login-email-error').style.display = 'block';
                hasError = true;
            }
            
            if (!password) {
                document.getElementById('login-password-error').style.display = 'block';
                hasError = true;
            }
            
            if (hasError) return;
            
            button.classList.add('loading');
            
            try {
                await signInWithEmailAndPassword(auth, email, password);
                
                console.log(`Connexion réussie pour ${email}`);
                logElement.textContent = 'Connexion réussie !';
                logElement.className = 'log-message success';
                logElement.style.display = 'block';
                
            } catch (error) {
                console.error(`Erreur connexion: ${error.message}`);
                
                let errorMessage = 'Erreur de connexion';
                if (error.code === 'auth/user-not-found') {
                    errorMessage = 'Aucun compte trouvé avec cet email';
                } else if (error.code === 'auth/wrong-password') {
                    errorMessage = 'Mot de passe incorrect';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'Adresse email invalide';
                } else if (error.code === 'auth/too-many-requests') {
                    errorMessage = 'Trop de tentatives. Réessayez plus tard';
                }
                
                logElement.textContent = errorMessage;
                logElement.className = 'log-message error';
                logElement.style.display = 'block';
            }
            
            button.classList.remove('loading');
        }

        async function registerUser() {
            const email = document.getElementById('register-email').value.trim();
            const password = document.getElementById('register-password').value;
            const confirmPassword = document.getElementById('register-confirm-password').value;
            const button = document.getElementById('registerBtn');
            const logElement = document.getElementById('register-log');
            
            clearAuthErrors();
            
            let hasError = false;
            
            if (!email || !email.includes('@')) {
                document.getElementById('register-email-error').style.display = 'block';
                hasError = true;
            }
            
            if (password.length < 6) {
                document.getElementById('register-password-error').style.display = 'block';
                hasError = true;
            }
            
            if (password !== confirmPassword) {
                document.getElementById('register-confirm-password-error').style.display = 'block';
                hasError = true;
            }
            
            if (hasError) return;
            
            button.classList.add('loading');
            
            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;
                
                const userData = {
                    email: user.email,
                    displayName: user.displayName || 'Utilisateur',
                    avatar: 'king1', // Avatar par défaut
                    createdAt: serverTimestamp(),
                    updatedAt: serverTimestamp(),
                    uid: user.uid
                };
                
                await setDoc(doc(db, "Users", user.uid), userData);
                
                console.log(`Inscription réussie pour ${email}`);
                logElement.textContent = 'Compte créé avec succès !';
                logElement.className = 'log-message success';
                logElement.style.display = 'block';
                
            } catch (error) {
                console.error(`Erreur inscription: ${error.message}`);
                
                let errorMessage = 'Erreur lors de la création du compte';
                if (error.code === 'auth/email-already-in-use') {
                    errorMessage = 'Un compte existe déjà avec cet email';
                } else if (error.code === 'auth/invalid-email') {
                    errorMessage = 'Adresse email invalide';
                } else if (error.code === 'auth/weak-password') {
                    errorMessage = 'Le mot de passe est trop faible';
                }
                
                logElement.textContent = errorMessage;
                logElement.className = 'log-message error';
                logElement.style.display = 'block';
            }
            
            button.classList.remove('loading');
        }

        async function loadUserData() {
            if (!currentUser) return;
            
            try {
                const userDoc = await getDoc(doc(db, "Users", currentUser.uid));
                
                if (userDoc.exists()) {
                    currentUserData = userDoc.data();
                    selectedAvatar = currentUserData.avatar || 'king1'; // Avatar par défaut
                } else {
                    const userData = {
                        email: currentUser.email,
                        displayName: currentUser.displayName || 'Utilisateur',
                        avatar: 'king1', // Avatar par défaut
                        createdAt: serverTimestamp(),
                        updatedAt: serverTimestamp(),
                        uid: currentUser.uid
                    };
                    
                    await setDoc(doc(db, "Users", currentUser.uid), userData);
                    currentUserData = userData;
                    selectedAvatar = 'king1';
                }
                
                updateProfileDisplay();
                console.log('Données utilisateur chargées');
                
            } catch (error) {
                console.error('Erreur chargement données utilisateur:', error);
            }
        }

        function updateProfileDisplay() {
            if (!currentUserData) return;
            
            const profileNameText = document.getElementById('profile-name-text');
            const profileEmail = document.getElementById('profile-email');
            
            if (profileNameText) {
                profileNameText.textContent = currentUserData.displayName || 'Utilisateur';
            }
            
            if (profileEmail) {
                profileEmail.textContent = currentUser.email;
            }

            // Check if user is admin
            if (ADMIN_EMAILS.includes(currentUser.email)) {
                isAdmin = true;
                document.getElementById('admin-badge').style.display = 'inline-block';
            }

            // Update avatar
            updateProfileAvatar();
        }

        function showAuthScreen() {
            document.getElementById('auth-screen').style.display = 'flex';
            document.getElementById('loading').style.display = 'none';
            hideMainApp();
        }

        function showMainApp() {
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('loading').style.display = 'none';
            
            document.querySelector('.header').style.display = 'flex';
            document.querySelector('.main-content').style.display = 'block';
            document.querySelector('.bottom-nav').style.display = 'flex';
            
            showSection('forecasts');
        }

        function hideMainApp() {
            document.querySelector('.header').style.display = 'none';
            document.querySelector('.main-content').style.display = 'none';
            document.querySelector('.bottom-nav').style.display = 'none';
        }

        function showLoading() {
            document.getElementById('loading').style.display = 'flex';
        }

        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }

        async function logoutUser() {
            try {
                await signOut(auth);
                console.log('Utilisateur déconnecté avec succès');
                hideConfirmation('logout-confirmation');
                showNotification("Déconnecté avec succès", "success");
                
                isLoggedIn = false;
                currentUser = null;
                currentUserData = null;
                isAdmin = false;
                selectedAvatar = null;
                
                showAuthScreen();
                
            } catch (error) {
                console.error(`Erreur déconnexion: ${error.message}`);
                showNotification("Erreur lors de la déconnexion", "error");
            }
        }

        function showConfirmation(dialogId) {
            document.getElementById(dialogId).classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }

        function hideConfirmation(dialogId) {
            document.getElementById(dialogId).classList.remove('active');
            document.getElementById('overlay').classList.remove('active');
        }

        // Event listeners setup
        function setupEventListeners() {
            // Menu
            document.getElementById('menu-btn').addEventListener('click', function() {
                document.getElementById('side-menu').classList.add('active');
                document.getElementById('side-menu-overlay').classList.add('active');
            });
            
            document.getElementById('side-menu-close').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
            });
            
            document.getElementById('side-menu-overlay').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
            });

            // Menu items
            document.getElementById('menu-history').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
                showSection('history');
            });
            
            document.getElementById('menu-interface').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
                showSection('interface');
            });

            document.getElementById('menu-terms').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
                
                const termsContent = `
                    <h3>Conditions d'utilisation</h3>
                    <p>En utilisant KING PRONOS, vous acceptez les conditions suivantes :</p>
                    
                    <h3>Utilisation des services</h3>
                    <p>• Les pronostics fournis sont à des fins de divertissement uniquement<br>
                    • Nous ne garantissons aucun résultat financier<br>
                    • L'utilisateur est seul responsable de ses décisions de paris<br>
                    • Il est interdit de partager votre compte avec des tiers</p>
                    
                    <h3>Responsabilités</h3>
                    <p>• KING PRONOS décline toute responsabilité en cas de pertes financières<br>
                    • Les utilisateurs doivent parier de manière responsable<br>
                    • Les mineurs ne sont pas autorisés à utiliser nos services</p>
                    
                    <h3>Propriété intellectuelle</h3>
                    <p>• Tous les contenus sont protégés par des droits d'auteur<br>
                    • La reproduction non autorisée est interdite</p>
                    
                    <h3>Modification des conditions</h3>
                    <p>Nous nous réservons le droit de modifier ces conditions à tout moment. Les utilisateurs seront informés des changements majeurs.</p>
                `;
                
                showInfoModal('Conditions d\'utilisation', termsContent);
            });

            document.getElementById('menu-about').addEventListener('click', function() {
                document.getElementById('side-menu').classList.remove('active');
                document.getElementById('side-menu-overlay').classList.remove('active');
                
                const aboutContent = `
                    <h3>À propos de KING PRONOS</h3>
                    <p>KING PRONOS est une application avancée de pronostics sportifs utilisant l'intelligence artificielle pour fournir des prédictions de haute qualité.</p>
                    
                    <h3>Notre mission</h3>
                    <p>Fournir aux passionnés de sport des analyses approfondies et des pronostics fiables basés sur des données statistiques avancées et des algorithmes d'IA.</p>
                    
                    <h3>Fonctionnalités</h3>
                    <p>• Pronostics simples quotidiens<br>
                    • Singles Premium avec analyse IA<br>
                    • Pronostics Safes à faible risque<br>
                    • Analyses détaillées avec probabilités<br>
                    • Interface moderne et intuitive</p>
                    
                    <h3>Technologie</h3>
                    <p>Notre plateforme utilise des modèles de Poisson, des analyses statistiques avancées et des algorithmes d'apprentissage automatique pour générer nos prédictions.</p>
                    
                    <h3>Contact</h3>
                    <p>Rejoignez notre communauté sur WhatsApp, Telegram ou YouTube pour plus d'informations et de support.</p>
                    
                    <h3>Version</h3>
                    <p>Application v3.7 - Dernière mise à jour : Janvier 2025</p>
                `;
                
                showInfoModal('À propos', aboutContent);
            });

            // Info modal
            document.getElementById('info-modal-close').addEventListener('click', closeInfoModal);

            // Back button
            document.getElementById('back-btn').addEventListener('click', function() {
                showSection('forecasts');
            });

            // Bottom navigation
            document.querySelectorAll('.nav-item').forEach(item => {
                item.addEventListener('click', function() {
                    const section = this.dataset.section;
                    showSection(section);
                });
            });

            // AI forecast tabs - updated for new tabs
            document.querySelectorAll('.ai-forecast-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchAIForecastTab(tabId);
                });
            });

            // Detail view
            document.getElementById('detail-back-btn').addEventListener('click', closeForecastDetail);

            // Detail tabs
            document.querySelectorAll('.detail-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.dataset.tab;
                    switchDetailTab(tabId);
                });
            });

            // Profile picture click
            document.getElementById('profile-pic').addEventListener('click', openAvatarViewer);

            // Avatar viewer buttons
            document.getElementById('avatar-viewer-close').addEventListener('click', closeAvatarViewer);
            document.getElementById('avatar-edit-btn').addEventListener('click', function() {
                closeAvatarViewer();
                openAvatarSelector();
            });

            // Avatar selector modal
            document.getElementById('avatar-modal-cancel').addEventListener('click', closeAvatarSelector);
            document.getElementById('avatar-modal-save').addEventListener('click', saveSelectedAvatar);

            // Theme selector
            document.querySelectorAll('.theme-option').forEach(option => {
                option.addEventListener('click', function() {
                    const theme = this.getAttribute('data-theme');
                    selectedTheme = theme;
                    
                    const themeClasses = ['theme-green', 'theme-red', 'theme-orange', 'theme-purple', 'theme-teal', 'theme-indigo', 'theme-pink', 'theme-cyan', 'theme-lime', 'theme-amber', 'theme-deep-orange'];
                    document.documentElement.classList.remove(...themeClasses);
                    
                    if (theme !== 'default') {
                        document.documentElement.classList.add(`theme-${theme}`);
                    }
                    
                    document.querySelectorAll('.theme-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                    
                    localStorage.setItem('kingPronosTheme', theme);
                    
                    const themeNames = {
                        'default': 'Bleu',
                        'green': 'Vert',
                        'red': 'Rouge',
                        'orange': 'Orange',
                        'purple': 'Violet',
                        'teal': 'Turquoise',
                        'indigo': 'Indigo',
                        'pink': 'Rose',
                        'cyan': 'Cyan',
                        'lime': 'Lime',
                        'amber': 'Ambre',
                        'deep-orange': 'Orange Foncé'
                    };
                    
                    showNotification(`Thème ${themeNames[theme]} appliqué`, 'success');
                });
            });

            // Dark mode toggle
            document.getElementById('dark-toggle').addEventListener('change', function() {
                if (this.checked) {
                    document.documentElement.classList.add('dark');
                } else {
                    document.documentElement.classList.remove('dark');
                }
                
                localStorage.setItem('kingPronosDarkMode', this.checked ? 'true' : 'false');
            });

            // Logout
            document.getElementById('logout-btn').addEventListener('click', () => showConfirmation('logout-confirmation'));
            document.getElementById('logout-cancel').addEventListener('click', () => hideConfirmation('logout-confirmation'));
            document.getElementById('logout-confirm').addEventListener('click', logoutUser);

            // Delete account
            document.getElementById('delete-account-btn').addEventListener('click', () => showConfirmation('delete-account-confirmation'));
            document.getElementById('delete-account-cancel').addEventListener('click', () => hideConfirmation('delete-account-confirmation'));
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            showLoading();
            setupEventListeners();
            setupAuth();
            setupTheme();
            setupDarkMode();
            
            console.log('Application KING PRONOS initialisée');
            
            setTimeout(() => {
                if (!isLoggedIn) {
                    hideLoading();
                }
            }, 3000);
        });
    </script>
    <script>
  if ('serviceWorker' in navigator) {
    window.addEventListener('load', () => {
      navigator.serviceWorker.register('service-worker.js')
        .then(registration => {
          console.log('Service Worker enregistré avec succès :', registration.scope);
        })
        .catch(error => {
          console.log('Échec de l'enregistrement du Service Worker :', error);
        });
    });
  }
</script>
</body>
</html>
